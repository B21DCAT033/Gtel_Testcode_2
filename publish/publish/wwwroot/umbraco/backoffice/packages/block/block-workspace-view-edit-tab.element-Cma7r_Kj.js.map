{"version":3,"file":"block-workspace-view-edit-tab.element-Cma7r_Kj.js","sources":["../../../src/packages/block/block/workspace/views/edit/block-workspace-view-edit-properties.element.ts","../../../src/packages/block/block/workspace/views/edit/block-workspace-view-edit-tab.element.ts"],"sourcesContent":["import type { UmbBlockWorkspaceElementManagerNames } from '../../block-workspace.context.js';\r\nimport { UMB_BLOCK_WORKSPACE_CONTEXT } from '../../block-workspace.context-token.js';\r\nimport { css, html, customElement, property, state, repeat } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { UmbContentTypeModel, UmbPropertyTypeModel } from '@umbraco-cms/backoffice/content-type';\r\nimport { UmbContentTypePropertyStructureHelper } from '@umbraco-cms/backoffice/content-type';\r\nimport { UmbLitElement, umbDestroyOnDisconnect } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbVariantId } from '@umbraco-cms/backoffice/variant';\r\nimport { UmbDataPathPropertyValueQuery } from '@umbraco-cms/backoffice/validation';\r\n\r\n@customElement('umb-block-workspace-view-edit-properties')\r\nexport class UmbBlockWorkspaceViewEditPropertiesElement extends UmbLitElement {\r\n\t#managerName?: UmbBlockWorkspaceElementManagerNames;\r\n\t#blockWorkspace?: typeof UMB_BLOCK_WORKSPACE_CONTEXT.TYPE;\r\n\t#propertyStructureHelper = new UmbContentTypePropertyStructureHelper<UmbContentTypeModel>(this);\r\n\r\n\t@property({ attribute: false })\r\n\tpublic get managerName(): UmbBlockWorkspaceElementManagerNames | undefined {\r\n\t\treturn this.#managerName;\r\n\t}\r\n\tpublic set managerName(value: UmbBlockWorkspaceElementManagerNames | undefined) {\r\n\t\tthis.#managerName = value;\r\n\t\tthis.#setStructureManager();\r\n\t}\r\n\r\n\t@property({ type: String, attribute: 'container-name', reflect: false })\r\n\tpublic get containerId(): string | null | undefined {\r\n\t\treturn this.#propertyStructureHelper.getContainerId();\r\n\t}\r\n\tpublic set containerId(value: string | null | undefined) {\r\n\t\tthis.#propertyStructureHelper.setContainerId(value);\r\n\t}\r\n\r\n\t@state()\r\n\t_propertyStructure: Array<UmbPropertyTypeModel> = [];\r\n\r\n\t@state()\r\n\t_dataPaths?: Array<string>;\r\n\r\n\t@state()\r\n\tprivate _ownerEntityType?: string;\r\n\r\n\t#variantId?: UmbVariantId;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_BLOCK_WORKSPACE_CONTEXT, (workspaceContext) => {\r\n\t\t\tthis.#blockWorkspace = workspaceContext;\r\n\t\t\tthis._ownerEntityType = this.#blockWorkspace.getEntityType();\r\n\t\t\tthis.observe(\r\n\t\t\t\tworkspaceContext.variantId,\r\n\t\t\t\t(variantId) => {\r\n\t\t\t\t\tthis.#variantId = variantId;\r\n\t\t\t\t\tthis.#generatePropertyDataPath();\r\n\t\t\t\t},\r\n\t\t\t\t'observeVariantId',\r\n\t\t\t);\r\n\t\t\tthis.#setStructureManager();\r\n\t\t});\r\n\t}\r\n\r\n\t#setStructureManager() {\r\n\t\tif (!this.#blockWorkspace || !this.#managerName) return;\r\n\t\tthis.#propertyStructureHelper.setStructureManager(this.#blockWorkspace[this.#managerName].structure);\r\n\t\tthis.observe(\r\n\t\t\tthis.#propertyStructureHelper.propertyStructure,\r\n\t\t\t(propertyStructure) => {\r\n\t\t\t\tthis._propertyStructure = propertyStructure;\r\n\t\t\t\tthis.#generatePropertyDataPath();\r\n\t\t\t},\r\n\t\t\t'observePropertyStructure',\r\n\t\t);\r\n\t}\r\n\r\n\t/*\r\n\t#generatePropertyDataPath() {\r\n\t\tif (!this._propertyStructure) return;\r\n\t\tthis._dataPaths = this._propertyStructure.map((property) => `$.${property.alias}`);\r\n\t}\r\n\t\t*/\r\n\r\n\t#generatePropertyDataPath() {\r\n\t\tif (!this.#variantId || !this._propertyStructure) return;\r\n\t\tthis._dataPaths = this._propertyStructure.map(\r\n\t\t\t(property) =>\r\n\t\t\t\t`$.values[${UmbDataPathPropertyValueQuery({\r\n\t\t\t\t\talias: property.alias,\r\n\t\t\t\t\tculture: property.variesByCulture ? this.#variantId!.culture : null,\r\n\t\t\t\t\tsegment: property.variesBySegment ? this.#variantId!.segment : null,\r\n\t\t\t\t})}].value`,\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn repeat(\r\n\t\t\tthis._propertyStructure,\r\n\t\t\t(property) => property.alias,\r\n\t\t\t(property, index) =>\r\n\t\t\t\thtml`<umb-property-type-based-property\r\n\t\t\t\t\tclass=\"property\"\r\n\t\t\t\t\tdata-path=${this._dataPaths![index]}\r\n\t\t\t\t\t.ownerEntityType=${this._ownerEntityType}\r\n\t\t\t\t\t.property=${property}\r\n\t\t\t\t\t${umbDestroyOnDisconnect()}></umb-property-type-based-property>`,\r\n\t\t);\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t.property {\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-divider);\r\n\t\t\t}\r\n\t\t\t.property:last-child {\r\n\t\t\t\tborder-bottom: 0;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbBlockWorkspaceViewEditPropertiesElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-block-workspace-view-edit-properties': UmbBlockWorkspaceViewEditPropertiesElement;\r\n\t}\r\n}\r\n","import { UMB_BLOCK_WORKSPACE_CONTEXT } from '../../block-workspace.context-token.js';\r\nimport { css, html, customElement, property, state, repeat } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { UmbContentTypeModel, UmbPropertyTypeContainerModel } from '@umbraco-cms/backoffice/content-type';\r\nimport { UmbContentTypeContainerStructureHelper } from '@umbraco-cms/backoffice/content-type';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\n\r\nimport './block-workspace-view-edit-properties.element.js';\r\n// eslint-disable-next-line import/order\r\nimport type { UmbBlockWorkspaceElementManagerNames } from '../../block-workspace.context.js';\r\n\r\n@customElement('umb-block-workspace-view-edit-tab')\r\nexport class UmbBlockWorkspaceViewEditTabElement extends UmbLitElement {\r\n\t@property({ attribute: false })\r\n\tpublic get managerName(): UmbBlockWorkspaceElementManagerNames | undefined {\r\n\t\treturn this.#managerName;\r\n\t}\r\n\tpublic set managerName(value: UmbBlockWorkspaceElementManagerNames | undefined) {\r\n\t\tthis.#managerName = value;\r\n\t\tthis.#setStructureManager();\r\n\t}\r\n\t#managerName?: UmbBlockWorkspaceElementManagerNames;\r\n\t#blockWorkspace?: typeof UMB_BLOCK_WORKSPACE_CONTEXT.TYPE;\r\n\t#groupStructureHelper = new UmbContentTypeContainerStructureHelper<UmbContentTypeModel>(this);\r\n\r\n\t@property({ type: String })\r\n\tpublic get containerId(): string | null | undefined {\r\n\t\treturn this._containerId;\r\n\t}\r\n\tpublic set containerId(value: string | null | undefined) {\r\n\t\tthis._containerId = value;\r\n\t\tthis.#groupStructureHelper.setContainerId(value);\r\n\t}\r\n\t@state()\r\n\tprivate _containerId?: string | null;\r\n\r\n\t/**\r\n\t * If true, the group box will be hidden, if we are to only represents one group.\r\n\t * This is used by Inline Editing Mode of Block List Editor.\r\n\t */\r\n\t@property({ type: Boolean, reflect: false })\r\n\thideSingleGroup = false;\r\n\r\n\t@state()\r\n\t_groups: Array<UmbPropertyTypeContainerModel> = [];\r\n\r\n\t@state()\r\n\t_hasProperties = false;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_BLOCK_WORKSPACE_CONTEXT, (workspaceContext) => {\r\n\t\t\tthis.#blockWorkspace = workspaceContext;\r\n\t\t\tthis.#setStructureManager();\r\n\t\t});\r\n\t}\r\n\r\n\t#setStructureManager() {\r\n\t\tif (!this.#blockWorkspace || !this.#managerName) return;\r\n\t\tthis.#groupStructureHelper.setStructureManager(this.#blockWorkspace[this.#managerName].structure);\r\n\t\tthis.observe(\r\n\t\t\tthis.#groupStructureHelper.mergedContainers,\r\n\t\t\t(groups) => {\r\n\t\t\t\tthis._groups = groups;\r\n\t\t\t},\r\n\t\t\t'observeGroups',\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#groupStructureHelper.hasProperties,\r\n\t\t\t(hasProperties) => {\r\n\t\t\t\tthis._hasProperties = hasProperties;\r\n\t\t\t},\r\n\t\t\t'observeHasProperties',\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t${this._hasProperties\r\n\t\t\t\t? html` <umb-block-workspace-view-edit-properties\r\n\t\t\t\t\t\t.managerName=${this.#managerName}\r\n\t\t\t\t\t\tdata-mark=\"property-group:root\"\r\n\t\t\t\t\t\t.containerId=${this._containerId}></umb-block-workspace-view-edit-properties>`\r\n\t\t\t\t: ''}\r\n\t\t\t${this.hideSingleGroup && this._groups.length === 1\r\n\t\t\t\t? this.renderGroup(this._groups[0])\r\n\t\t\t\t: repeat(\r\n\t\t\t\t\t\tthis._groups,\r\n\t\t\t\t\t\t(group) => group.id,\r\n\t\t\t\t\t\t(group) => html` <uui-box .headline=${group.name}>${this.renderGroup(group)}</uui-box>`,\r\n\t\t\t\t\t)}\r\n\t\t`;\r\n\t}\r\n\r\n\trenderGroup(group: UmbPropertyTypeContainerModel) {\r\n\t\treturn html`\r\n\t\t\t<umb-block-workspace-view-edit-properties\r\n\t\t\t\t.managerName=${this.#managerName}\r\n\t\t\t\tdata-mark=\"property-group:${group.name}\"\r\n\t\t\t\t.containerId=${group.id}></umb-block-workspace-view-edit-properties>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\tuui-box {\r\n\t\t\t\t--uui-box-default-padding: 0 var(--uui-size-space-5);\r\n\t\t\t}\r\n\t\t\tuui-box:not(:first-child) {\r\n\t\t\t\tmargin-top: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbBlockWorkspaceViewEditTabElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-block-workspace-view-edit-tab': UmbBlockWorkspaceViewEditTabElement;\r\n\t}\r\n}\r\n"],"names":["_managerName","_blockWorkspace","_propertyStructureHelper","_variantId","_UmbBlockWorkspaceViewEditPropertiesElement_instances","setStructureManager_fn","generatePropertyDataPath_fn","UmbBlockWorkspaceViewEditPropertiesElement","UmbLitElement","__privateAdd","UmbContentTypePropertyStructureHelper","UMB_BLOCK_WORKSPACE_CONTEXT","workspaceContext","__privateSet","__privateGet","variantId","__privateMethod","value","repeat","property","index","html","umbDestroyOnDisconnect","propertyStructure","UmbDataPathPropertyValueQuery","UmbTextStyles","css","__decorateClass","state","customElement","_groupStructureHelper","_UmbBlockWorkspaceViewEditTabElement_instances","UmbBlockWorkspaceViewEditTabElement","UmbContentTypeContainerStructureHelper","group","groups","hasProperties","UmbBlockWorkspaceViewEditTabElement$1"],"mappings":";;;;;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAWa,IAAAC,IAAN,cAAyDC,EAAc;AAAA,EAiC7E,cAAc;AACP,UAAA,GAlCDC,EAAA,MAAAL,CAAA,GACNK,EAAA,MAAAT,CAAA,GACAS,EAAA,MAAAR,CAAA,GAC2BQ,EAAA,MAAAP,GAAA,IAAIQ,EAA2D,IAAI,CAAA,GAoB9F,KAAA,qBAAkD,CAAC,GAQnDD,EAAA,MAAAN,CAAA,GAKM,KAAA,eAAeQ,GAA6B,CAACC,MAAqB;AACtEC,MAAAA,EAAA,MAAKZ,GAAkBW,CAAA,GAClB,KAAA,mBAAmBE,EAAK,MAAAb,CAAA,EAAgB,cAAc,GACtD,KAAA;AAAA,QACJW,EAAiB;AAAA,QACjB,CAACG,MAAc;AACdF,UAAAA,EAAA,MAAKV,GAAaY,CAAA,GAClBC,EAAA,MAAKZ,GAALE,CAAA,EAAA,KAAA,IAAA;AAAA,QACD;AAAA,QACA;AAAA,MACD,GACAU,EAAA,MAAKZ,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,IAAA,CACA;AAAA,EAAA;AAAA,EA1CF,IAAW,cAAgE;AAC1E,WAAOS,EAAK,MAAAd,CAAA;AAAA,EAAA;AAAA,EAEb,IAAW,YAAYiB,GAAyD;AAC/EJ,IAAAA,EAAA,MAAKb,GAAeiB,CAAA,GACpBD,EAAA,MAAKZ,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,EAAA;AAAA,EAID,IAAW,cAAyC;AAC5C,WAAAS,EAAA,MAAKZ,GAAyB,eAAe;AAAA,EAAA;AAAA,EAErD,IAAW,YAAYe,GAAkC;AACnDH,IAAAA,EAAA,MAAAZ,CAAA,EAAyB,eAAee,CAAK;AAAA,EAAA;AAAA,EAgE1C,SAAS;AACV,WAAAC;AAAA,MACN,KAAK;AAAA,MACL,CAACC,MAAaA,EAAS;AAAA,MACvB,CAACA,GAAUC,MACVC;AAAA;AAAA,iBAEa,KAAK,WAAYD,CAAK,CAAC;AAAA,wBAChB,KAAK,gBAAgB;AAAA,iBAC5BD,CAAQ;AAAA,OAClBG,EAAwB,CAAA;AAAA,IAC7B;AAAA,EAAA;AAcF;AA3GCtB,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AA4BAC,IAAA,oBAAA,QAAA;AA/BMC,IAAA,oBAAA,QAAA;AAmDNC,IAAoB,WAAG;AACtB,EAAI,CAACS,EAAA,MAAKb,CAAmB,KAAA,CAACa,QAAKd,CAAc,MACjDc,EAAA,MAAKZ,GAAyB,oBAAoBY,EAAA,MAAKb,GAAgBa,EAAK,MAAAd,CAAA,CAAY,EAAE,SAAS,GAC9F,KAAA;AAAA,IACJc,QAAKZ,CAAyB,EAAA;AAAA,IAC9B,CAACqB,MAAsB;AACtB,WAAK,qBAAqBA,GAC1BP,EAAA,MAAKZ,GAALE,CAAA,EAAA,KAAA,IAAA;AAAA,IACD;AAAA,IACA;AAAA,EACD;AACD;AASAA,IAAyB,WAAG;AAC3B,EAAI,CAACQ,EAAA,MAAKX,CAAc,KAAA,CAAC,KAAK,uBACzB,KAAA,aAAa,KAAK,mBAAmB;AAAA,IACzC,CAACgB,MACA,YAAYK,EAA8B;AAAA,MACzC,OAAOL,EAAS;AAAA,MAChB,SAASA,EAAS,kBAAkBL,EAAA,MAAKX,GAAY,UAAU;AAAA,MAC/D,SAASgB,EAAS,kBAAkBL,EAAA,MAAKX,GAAY,UAAU;AAAA,IAC/D,CAAA,CAAC;AAAA,EACJ;AACD;AAjFYI,EAiGI,SAAS;AAAA,EACxBkB;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQD;AArGWC,EAAA;AAAA,EADVR,EAAS,EAAE,WAAW,GAAO,CAAA;AAAA,GALlBZ,EAMD,WAAA,eAAA,CAAA;AASAoB,EAAA;AAAA,EADVR,EAAS,EAAE,MAAM,QAAQ,WAAW,kBAAkB,SAAS,GAAO,CAAA;AAAA,GAd3DZ,EAeD,WAAA,eAAA,CAAA;AAQXoB,EAAA;AAAA,EADCC,EAAM;AAAA,GAtBKrB,EAuBZ,WAAA,sBAAA,CAAA;AAGAoB,EAAA;AAAA,EADCC,EAAM;AAAA,GAzBKrB,EA0BZ,WAAA,cAAA,CAAA;AAGQoB,EAAA;AAAA,EADPC,EAAM;AAAA,GA5BKrB,EA6BJ,WAAA,oBAAA,CAAA;AA7BIA,IAANoB,EAAA;AAAA,EADNE,EAAc,0CAA0C;AAAA,GAC5CtB,CAAA;;;;;;;wYCXbP,GAAAC,GAAA6B,GAAAC,GAAA1B;AAYa,IAAA2B,IAAN,cAAkDxB,EAAc;AAAA,EAqCtE,cAAc;AACP,UAAA,GAtCDC,EAAA,MAAAsB,CAAA,GASNtB,EAAA,MAAAT,CAAA,GACAS,EAAA,MAAAR,CAAA,GACwBQ,EAAA,MAAAqB,GAAA,IAAIG,EAA4D,IAAI,CAAA,GAkB1E,KAAA,kBAAA,IAGlB,KAAA,UAAgD,CAAC,GAGhC,KAAA,iBAAA,IAKX,KAAA,eAAetB,GAA6B,CAACC,MAAqB;AACtE,MAAAC,EAAA,MAAKZ,GAAkBW,CAAA,GACvBI,EAAA,MAAKe,GAAL1B,CAAA,EAAA,KAAA,IAAA;AAAA,IAAA,CACA;AAAA,EAAA;AAAA,EAzCF,IAAW,cAAgE;AAC1E,WAAOS,EAAK,MAAAd,CAAA;AAAA,EAAA;AAAA,EAEb,IAAW,YAAYiB,GAAyD;AAC/E,IAAAJ,EAAA,MAAKb,GAAeiB,CAAA,GACpBD,EAAA,MAAKe,GAAL1B,CAAA,EAAA,KAAA,IAAA;AAAA,EAAA;AAAA,EAOD,IAAW,cAAyC;AACnD,WAAO,KAAK;AAAA,EAAA;AAAA,EAEb,IAAW,YAAYY,GAAkC;AACxD,SAAK,eAAeA,GACfH,EAAA,MAAAgB,CAAA,EAAsB,eAAeb,CAAK;AAAA,EAAA;AAAA,EA8CvC,SAAS;AACV,WAAAI;AAAA,KACJ,KAAK,iBACJA;AAAA,qBACeP,QAAKd,CAAY,CAAA;AAAA;AAAA,qBAEjB,KAAK,YAAY,iDAChC,EAAE;AAAA,KACH,KAAK,mBAAmB,KAAK,QAAQ,WAAW,IAC/C,KAAK,YAAY,KAAK,QAAQ,CAAC,CAAC,IAChCkB;AAAA,MACA,KAAK;AAAA,MACL,CAACgB,MAAUA,EAAM;AAAA,MACjB,CAACA,MAAUb,wBAA2Ba,EAAM,IAAI,IAAI,KAAK,YAAYA,CAAK,CAAC;AAAA,IAC3E,CAAA;AAAA;AAAA,EAAA;AAAA,EAIL,YAAYA,GAAsC;AAC1C,WAAAb;AAAA;AAAA,mBAEUP,QAAKd,CAAY,CAAA;AAAA,gCACJkC,EAAM,IAAI;AAAA,mBACvBA,EAAM,EAAE;AAAA;AAAA,EAAA;AAe3B;AA9FClC,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AACA6B,IAAA,oBAAA,QAAA;AAXMC,IAAA,oBAAA,QAAA;AA8CN1B,IAAoB,WAAG;AACtB,EAAI,CAACS,EAAA,MAAKb,CAAmB,KAAA,CAACa,QAAKd,CAAc,MACjDc,EAAA,MAAKgB,GAAsB,oBAAoBhB,EAAA,MAAKb,GAAgBa,EAAK,MAAAd,CAAA,CAAY,EAAE,SAAS,GAC3F,KAAA;AAAA,IACJc,QAAKgB,CAAsB,EAAA;AAAA,IAC3B,CAACK,MAAW;AACX,WAAK,UAAUA;AAAA,IAChB;AAAA,IACA;AAAA,EACD,GACK,KAAA;AAAA,IACJrB,QAAKgB,CAAsB,EAAA;AAAA,IAC3B,CAACM,MAAkB;AAClB,WAAK,iBAAiBA;AAAA,IACvB;AAAA,IACA;AAAA,EACD;AACD;AA/DYJ,EA4FI,SAAS;AAAA,EACxBP;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQD;AApGWC,EAAA;AAAA,EADVR,EAAS,EAAE,WAAW,GAAO,CAAA;AAAA,GADlBa,EAED,WAAA,eAAA,CAAA;AAYAL,EAAA;AAAA,EADVR,EAAS,EAAE,MAAM,OAAQ,CAAA;AAAA,GAbda,EAcD,WAAA,eAAA,CAAA;AAQHL,EAAA;AAAA,EADPC,EAAM;AAAA,GArBKI,EAsBJ,WAAA,gBAAA,CAAA;AAORL,EAAA;AAAA,EADCR,EAAS,EAAE,MAAM,SAAS,SAAS,GAAO,CAAA;AAAA,GA5B/Ba,EA6BZ,WAAA,mBAAA,CAAA;AAGAL,EAAA;AAAA,EADCC,EAAM;AAAA,GA/BKI,EAgCZ,WAAA,WAAA,CAAA;AAGAL,EAAA;AAAA,EADCC,EAAM;AAAA,GAlCKI,EAmCZ,WAAA,kBAAA,CAAA;AAnCYA,IAANL,EAAA;AAAA,EADNE,EAAc,mCAAmC;AAAA,GACrCG,CAAA;AAyGb,MAAAK,KAAeL;"}