{"version":3,"file":"rename-server-file.action-CCHxvQKq.js","sources":["../../../src/packages/core/server-file-system/rename/modal/rename-server-file-modal.token.ts","../../../src/packages/core/server-file-system/rename/event/server-file-renamed.entity-event.ts","../../../src/packages/core/server-file-system/rename/rename-server-file.action.ts"],"sourcesContent":["import { UMB_RENAME_SERVER_FILE_MODAL_ALIAS } from './manifests.js';\r\nimport { UmbModalToken } from '@umbraco-cms/backoffice/modal';\r\n\r\nexport interface UmbRenameModalData {\r\n\trenameRepositoryAlias: string;\r\n\titemRepositoryAlias: string;\r\n\tunique: string;\r\n}\r\n\r\nexport interface UmbRenameServerFileModalValue {\r\n\tunique: string;\r\n\tname: string;\r\n}\r\n\r\nexport const UMB_RENAME_SERVER_FILE_MODAL = new UmbModalToken<UmbRenameModalData, UmbRenameServerFileModalValue>(\r\n\tUMB_RENAME_SERVER_FILE_MODAL_ALIAS,\r\n\t{\r\n\t\tmodal: {\r\n\t\t\ttype: 'sidebar',\r\n\t\t\tsize: 'small',\r\n\t\t},\r\n\t},\r\n);\r\n","import type { UmbServerFileRenamedEventArgs } from './types.js';\r\nimport { UmbEntityActionEvent } from '@umbraco-cms/backoffice/entity-action';\r\n\r\nexport class UmbServerFileRenamedEntityEvent extends UmbEntityActionEvent<UmbServerFileRenamedEventArgs> {\r\n\tstatic readonly TYPE = 'server-file-renamed';\r\n\r\n\tconstructor(args: UmbServerFileRenamedEventArgs) {\r\n\t\tsuper(UmbServerFileRenamedEntityEvent.TYPE, args);\r\n\t}\r\n\r\n\tgetNewUnique(): string {\r\n\t\treturn this._args.newUnique;\r\n\t}\r\n\r\n\tgetNewName(): string {\r\n\t\treturn this._args.newName;\r\n\t}\r\n}\r\n","import { UMB_RENAME_SERVER_FILE_MODAL } from './modal/rename-server-file-modal.token.js';\r\nimport type { MetaEntityActionRenameServerFileKind } from './types.js';\r\nimport { UmbServerFileRenamedEntityEvent } from './event/index.js';\r\nimport { UmbEntityActionBase, UmbRequestReloadStructureForEntityEvent } from '@umbraco-cms/backoffice/entity-action';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_ACTION_EVENT_CONTEXT } from '@umbraco-cms/backoffice/action';\r\n\r\nexport class UmbRenameEntityAction extends UmbEntityActionBase<MetaEntityActionRenameServerFileKind> {\r\n\toverride async execute() {\r\n\t\tif (!this.args.unique) throw new Error('Unique is required to rename an entity');\r\n\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tconst modalContext = modalManager.open(this, UMB_RENAME_SERVER_FILE_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tunique: this.args.unique,\r\n\t\t\t\trenameRepositoryAlias: this.args.meta.renameRepositoryAlias,\r\n\t\t\t\titemRepositoryAlias: this.args.meta.itemRepositoryAlias,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\ttry {\r\n\t\t\tconst res = await modalContext.onSubmit();\r\n\r\n\t\t\tconst actionEventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\r\n\t\t\tconst event = new UmbRequestReloadStructureForEntityEvent({\r\n\t\t\t\tunique: this.args.unique,\r\n\t\t\t\tentityType: this.args.entityType,\r\n\t\t\t});\r\n\r\n\t\t\tactionEventContext.dispatchEvent(event);\r\n\r\n\t\t\tconst event2 = new UmbServerFileRenamedEntityEvent({\r\n\t\t\t\tunique: this.args.unique,\r\n\t\t\t\tentityType: this.args.entityType,\r\n\t\t\t\tnewName: res.name,\r\n\t\t\t\tnewUnique: res.unique,\r\n\t\t\t});\r\n\r\n\t\t\tactionEventContext.dispatchEvent(event2);\r\n\t\t} catch (error) {\r\n\t\t\t// TODO: Handle error\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default UmbRenameEntityAction;\r\n"],"names":["UMB_RENAME_SERVER_FILE_MODAL","UmbModalToken","UMB_RENAME_SERVER_FILE_MODAL_ALIAS","UmbServerFileRenamedEntityEvent","UmbEntityActionEvent","args","UmbRenameEntityAction","UmbEntityActionBase","modalContext","UMB_MODAL_MANAGER_CONTEXT","res","actionEventContext","UMB_ACTION_EVENT_CONTEXT","event","UmbRequestReloadStructureForEntityEvent","event2","error"],"mappings":";;;;AAcO,MAAMA,IAA+B,IAAIC;AAAA,EAC/CC;AAAA,EACA;AAAA,IACC,OAAO;AAAA,MACN,MAAM;AAAA,MACN,MAAM;AAAA,IAAA;AAAA,EACP;AAEF;ACnBO,MAAMC,UAAwCC,EAAoD;AAAA,EACxG,OAAA;AAAA,SAAgB,OAAO;AAAA,EAAA;AAAA,EAEvB,YAAYC,GAAqC;AAC1C,UAAAF,EAAgC,MAAME,CAAI;AAAA,EAAA;AAAA,EAGjD,eAAuB;AACtB,WAAO,KAAK,MAAM;AAAA,EAAA;AAAA,EAGnB,aAAqB;AACpB,WAAO,KAAK,MAAM;AAAA,EAAA;AAEpB;ACVO,MAAMC,UAA8BC,EAA0D;AAAA,EACpG,MAAe,UAAU;AACxB,QAAI,CAAC,KAAK,KAAK,OAAc,OAAA,IAAI,MAAM,wCAAwC;AAG/E,UAAMC,KADe,MAAM,KAAK,WAAWC,CAAyB,GAClC,KAAK,MAAMT,GAA8B;AAAA,MAC1E,MAAM;AAAA,QACL,QAAQ,KAAK,KAAK;AAAA,QAClB,uBAAuB,KAAK,KAAK,KAAK;AAAA,QACtC,qBAAqB,KAAK,KAAK,KAAK;AAAA,MAAA;AAAA,IACrC,CACA;AAEG,QAAA;AACG,YAAAU,IAAM,MAAMF,EAAa,SAAS,GAElCG,IAAqB,MAAM,KAAK,WAAWC,CAAwB,GACnEC,IAAQ,IAAIC,EAAwC;AAAA,QACzD,QAAQ,KAAK,KAAK;AAAA,QAClB,YAAY,KAAK,KAAK;AAAA,MAAA,CACtB;AAED,MAAAH,EAAmB,cAAcE,CAAK;AAEhC,YAAAE,IAAS,IAAIZ,EAAgC;AAAA,QAClD,QAAQ,KAAK,KAAK;AAAA,QAClB,YAAY,KAAK,KAAK;AAAA,QACtB,SAASO,EAAI;AAAA,QACb,WAAWA,EAAI;AAAA,MAAA,CACf;AAED,MAAAC,EAAmB,cAAcI,CAAM;AAAA,aAC/BC,GAAO;AAEf,cAAQ,IAAIA,CAAK;AAAA,IAAA;AAAA,EAClB;AAEF;;;;;;"}