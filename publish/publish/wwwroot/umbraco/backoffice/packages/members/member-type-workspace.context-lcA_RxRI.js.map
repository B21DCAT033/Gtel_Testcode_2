{"version":3,"file":"member-type-workspace.context-lcA_RxRI.js","sources":["../../../src/packages/members/member-type/workspace/member-type-workspace-editor.element.ts","../../../src/packages/members/member-type/workspace/member-type-workspace.context.ts"],"sourcesContent":["import { UMB_MEMBER_TYPE_WORKSPACE_CONTEXT } from './member-type-workspace.context-token.js';\r\nimport type { UmbInputWithAliasElement } from '@umbraco-cms/backoffice/components';\r\nimport { css, html, customElement, state, ifDefined } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UUITextareaElement } from '@umbraco-cms/backoffice/external/uui';\r\nimport { UmbLitElement, umbFocus } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_ICON_PICKER_MODAL } from '@umbraco-cms/backoffice/icon';\r\n\r\n@customElement('umb-member-type-workspace-editor')\r\nexport class UmbMemberTypeWorkspaceEditorElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _name?: string;\r\n\r\n\t@state()\r\n\tprivate _description?: string;\r\n\r\n\t@state()\r\n\tprivate _alias?: string;\r\n\r\n\t@state()\r\n\tprivate _icon?: string;\r\n\r\n\t@state()\r\n\tprivate _isNew?: boolean;\r\n\r\n\t#workspaceContext?: typeof UMB_MEMBER_TYPE_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_MEMBER_TYPE_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\t\t\tthis.#observeMemberType();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeMemberType() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\t\tthis.observe(this.#workspaceContext.name, (name) => (this._name = name), '_observeName');\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.description,\r\n\t\t\t(description) => (this._description = description),\r\n\t\t\t'_observeDescription',\r\n\t\t);\r\n\t\tthis.observe(this.#workspaceContext.alias, (alias) => (this._alias = alias), '_observeAlias');\r\n\t\tthis.observe(this.#workspaceContext.icon, (icon) => (this._icon = icon), '_observeIcon');\r\n\t\tthis.observe(this.#workspaceContext.isNew, (isNew) => (this._isNew = isNew), '_observeIsNew');\r\n\t}\r\n\r\n\tprivate async _handleIconClick() {\r\n\t\tconst [alias, color] = this._icon?.replace('color-', '')?.split(' ') ?? [];\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tconst modalContext = modalManager.open(this, UMB_ICON_PICKER_MODAL, {\r\n\t\t\tvalue: {\r\n\t\t\t\ticon: alias,\r\n\t\t\t\tcolor: color,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tmodalContext?.onSubmit().then((saved) => {\r\n\t\t\tif (saved.icon && saved.color) {\r\n\t\t\t\tthis.#workspaceContext?.set('icon', `${saved.icon} color-${saved.color}`);\r\n\t\t\t} else if (saved.icon) {\r\n\t\t\t\tthis.#workspaceContext?.set('icon', saved.icon);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t#onNameAndAliasChange(event: InputEvent & { target: UmbInputWithAliasElement }) {\r\n\t\tthis.#workspaceContext?.setName(event.target.value ?? '');\r\n\t\tthis.#workspaceContext?.setAlias(event.target.alias ?? '');\r\n\t}\r\n\r\n\t#onDescriptionChange(event: InputEvent & { target: UUITextareaElement }) {\r\n\t\tthis.#workspaceContext?.setDescription(event.target.value.toString() ?? '');\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-entity-detail-workspace-editor>\r\n\t\t\t\t<div id=\"header\" slot=\"header\">\r\n\t\t\t\t\t<uui-button id=\"icon\" compact label=\"icon\" look=\"outline\" @click=${this._handleIconClick}>\r\n\t\t\t\t\t\t<umb-icon name=${ifDefined(this._icon)}></umb-icon>\r\n\t\t\t\t\t</uui-button>\r\n\r\n\t\t\t\t\t<div id=\"editors\">\r\n\t\t\t\t\t\t<umb-input-with-alias\r\n\t\t\t\t\t\t\tid=\"name\"\r\n\t\t\t\t\t\t\tlabel=${this.localize.term('placeholders_entername')}\r\n\t\t\t\t\t\t\tvalue=${this._name}\r\n\t\t\t\t\t\t\talias=${this._alias}\r\n\t\t\t\t\t\t\t?auto-generate-alias=${this._isNew}\r\n\t\t\t\t\t\t\t@change=${this.#onNameAndAliasChange}\r\n\t\t\t\t\t\t\t${umbFocus()}>\r\n\t\t\t\t\t\t</umb-input-with-alias>\r\n\r\n\t\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\t\tid=\"description\"\r\n\t\t\t\t\t\t\t.label=${this.localize.term('placeholders_enterDescription')}\r\n\t\t\t\t\t\t\t.value=${this._description}\r\n\t\t\t\t\t\t\t.placeholder=${this.localize.term('placeholders_enterDescription')}\r\n\t\t\t\t\t\t\t@input=${this.#onDescriptionChange}></uui-input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-entity-detail-workspace-editor>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#header {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex: 1 1 auto;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t#editors {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex: 1 1 auto;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-1);\r\n\t\t\t}\r\n\r\n\t\t\t#name {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tflex: 1 1 auto;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t#description {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\t--uui-input-height: var(--uui-size-8);\r\n\t\t\t\t--uui-input-border-color: transparent;\r\n\t\t\t}\r\n\r\n\t\t\t#description:hover {\r\n\t\t\t\t--uui-input-border-color: var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t#alias-lock {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t}\r\n\t\t\t#alias-lock uui-icon {\r\n\t\t\t\tmargin-bottom: 2px;\r\n\t\t\t}\r\n\r\n\t\t\t#icon {\r\n\t\t\t\tfont-size: var(--uui-size-8);\r\n\t\t\t\theight: 60px;\r\n\t\t\t\twidth: 60px;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbMemberTypeWorkspaceEditorElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-member-type-workspace-editor': UmbMemberTypeWorkspaceEditorElement;\r\n\t}\r\n}\r\n","import type { UmbMemberTypeDetailModel } from '../types.js';\r\nimport { UMB_MEMBER_TYPE_DETAIL_REPOSITORY_ALIAS, UMB_MEMBER_TYPE_ENTITY_TYPE } from '../index.js';\r\nimport { UmbMemberTypeWorkspaceEditorElement } from './member-type-workspace-editor.element.js';\r\nimport { UMB_MEMBER_TYPE_WORKSPACE_ALIAS } from './constants.js';\r\nimport {\r\n\ttype UmbRoutableWorkspaceContext,\r\n\tUmbWorkspaceIsNewRedirectController,\r\n} from '@umbraco-cms/backoffice/workspace';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport {\r\n\ttype UmbContentTypeWorkspaceContext,\r\n\tUmbContentTypeWorkspaceContextBase,\r\n} from '@umbraco-cms/backoffice/content-type';\r\nimport type { UmbEntityModel } from '@umbraco-cms/backoffice/entity';\r\n\r\ntype EntityDetailModel = UmbMemberTypeDetailModel;\r\nexport class UmbMemberTypeWorkspaceContext\r\n\textends UmbContentTypeWorkspaceContextBase<EntityDetailModel>\r\n\timplements UmbContentTypeWorkspaceContext<EntityDetailModel>, UmbRoutableWorkspaceContext\r\n{\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, {\r\n\t\t\tworkspaceAlias: UMB_MEMBER_TYPE_WORKSPACE_ALIAS,\r\n\t\t\tentityType: UMB_MEMBER_TYPE_ENTITY_TYPE,\r\n\t\t\tdetailRepositoryAlias: UMB_MEMBER_TYPE_DETAIL_REPOSITORY_ALIAS,\r\n\t\t});\r\n\r\n\t\tthis.routes.setRoutes([\r\n\t\t\t{\r\n\t\t\t\tpath: 'create/parent/:parentEntityType/:parentUnique',\r\n\t\t\t\tcomponent: UmbMemberTypeWorkspaceEditorElement,\r\n\t\t\t\tsetup: async (_component, info) => {\r\n\t\t\t\t\tconst parentEntityType = info.match.params.parentEntityType;\r\n\t\t\t\t\tconst parentUnique = info.match.params.parentUnique === 'null' ? null : info.match.params.parentUnique;\r\n\t\t\t\t\tconst parent: UmbEntityModel = { entityType: parentEntityType, unique: parentUnique };\r\n\t\t\t\t\tawait this.createScaffold({ parent });\r\n\r\n\t\t\t\t\tnew UmbWorkspaceIsNewRedirectController(\r\n\t\t\t\t\t\tthis,\r\n\t\t\t\t\t\tthis,\r\n\t\t\t\t\t\tthis.getHostElement().shadowRoot!.querySelector('umb-router-slot')!,\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tpath: 'edit/:unique',\r\n\t\t\t\tcomponent: UmbMemberTypeWorkspaceEditorElement,\r\n\t\t\t\tsetup: (_component, info) => {\r\n\t\t\t\t\tconst unique = info.match.params.unique;\r\n\t\t\t\t\tthis.load(unique);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t]);\r\n\t}\r\n\r\n\t/**\r\n\t * @deprecated Use the individual set methods instead. Will be removed in 17.\r\n\t * @template PropertyName\r\n\t * @param {PropertyName} propertyName\r\n\t * @param {EntityDetailModel[PropertyName]} value\r\n\t * @memberof UmbMemberTypeWorkspaceContext\r\n\t */\r\n\tset<PropertyName extends keyof EntityDetailModel>(\r\n\t\tpropertyName: PropertyName,\r\n\t\tvalue: EntityDetailModel[PropertyName],\r\n\t) {\r\n\t\tthis.structure.updateOwnerContentType({ [propertyName]: value });\r\n\t}\r\n\r\n\t/**\r\n\t * @deprecated Use the createScaffold method instead. Will be removed in 17.\r\n\t * @param {UmbEntityModel} parent\r\n\t * @memberof UmbMemberTypeWorkspaceContext\r\n\t */\r\n\tasync create(parent: UmbEntityModel) {\r\n\t\tthis.createScaffold({ parent });\r\n\t}\r\n}\r\n\r\nexport { UmbMemberTypeWorkspaceContext as api };\r\n"],"names":["_workspaceContext","_UmbMemberTypeWorkspaceEditorElement_instances","observeMemberType_fn","onNameAndAliasChange_fn","onDescriptionChange_fn","UmbMemberTypeWorkspaceEditorElement","UmbLitElement","__privateAdd","UMB_MEMBER_TYPE_WORKSPACE_CONTEXT","instance","__privateSet","__privateMethod","alias","color","UMB_MODAL_MANAGER_CONTEXT","UMB_ICON_PICKER_MODAL","saved","__privateGet","html","ifDefined","umbFocus","name","description","icon","isNew","event","css","__decorateClass","state","customElement","UmbMemberTypeWorkspaceContext","UmbContentTypeWorkspaceContextBase","host","UMB_MEMBER_TYPE_WORKSPACE_ALIAS","UMB_MEMBER_TYPE_ENTITY_TYPE","UMB_MEMBER_TYPE_DETAIL_REPOSITORY_ALIAS","_component","info","parentEntityType","parentUnique","parent","UmbWorkspaceIsNewRedirectController","unique","propertyName","value"],"mappings":";;;;;;;;;;;;;;;;;;;;wXAAAA,GAAAC,GAAAC,GAAAC,GAAAC;AASa,IAAAC,IAAN,cAAkDC,EAAc;AAAA,EAkBtE,cAAc;AACP,UAAA,GAnBDC,EAAA,MAAAN,CAAA,GAgBNM,EAAA,MAAAP,CAAA,GAKM,KAAA,eAAeQ,GAAmC,CAACC,MAAa;AACpE,MAAAC,EAAA,MAAKV,GAAoBS,CAAA,GACzBE,EAAA,MAAKV,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,IAAA,CACA;AAAA,EAAA;AAAA,EAgBF,MAAc,mBAAmB;AAChC,UAAM,CAACU,GAAOC,CAAK,IAAI,KAAK,OAAO,QAAQ,UAAU,EAAE,GAAG,MAAM,GAAG,KAAK,CAAC;AASzE,KARqB,MAAM,KAAK,WAAWC,CAAyB,GAClC,KAAK,MAAMC,GAAuB;AAAA,MACnE,OAAO;AAAA,QACN,MAAMH;AAAA,QACN,OAAAC;AAAA,MAAA;AAAA,IACD,CACA,GAEa,SAAS,EAAE,KAAK,CAACG,MAAU;AACpC,MAAAA,EAAM,QAAQA,EAAM,QAClBC,EAAA,MAAAjB,CAAA,GAAmB,IAAI,QAAQ,GAAGgB,EAAM,IAAI,UAAUA,EAAM,KAAK,EAAE,IAC9DA,EAAM,QAChBC,EAAA,MAAKjB,CAAmB,GAAA,IAAI,QAAQgB,EAAM,IAAI;AAAA,IAC/C,CACA;AAAA,EAAA;AAAA,EAYO,SAAS;AACV,WAAAE;AAAA;AAAA;AAAA,wEAG+D,KAAK,gBAAgB;AAAA,uBACtEC,EAAU,KAAK,KAAK,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAM7B,KAAK,SAAS,KAAK,wBAAwB,CAAC;AAAA,eAC5C,KAAK,KAAK;AAAA,eACV,KAAK,MAAM;AAAA,8BACI,KAAK,MAAM;AAAA,iBACxBR,QAAKV,GAAqBE,CAAA,CAAA;AAAA,SAClCiB,GAAU;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKH,KAAK,SAAS,KAAK,+BAA+B,CAAC;AAAA,gBACnD,KAAK,YAAY;AAAA,sBACX,KAAK,SAAS,KAAK,+BAA+B,CAAC;AAAA,gBACzDT,QAAKV,GAAoBG,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAA;AA6DzC;AAzICJ,IAAA,oBAAA,QAAA;AAhBMC,IAAA,oBAAA,QAAA;AA2BNC,IAAkB,WAAG;AAChB,EAACe,QAAKjB,CAAmB,MACxB,KAAA,QAAQiB,QAAKjB,CAAkB,EAAA,MAAM,CAACqB,MAAU,KAAK,QAAQA,GAAO,cAAc,GAClF,KAAA;AAAA,IACJJ,QAAKjB,CAAkB,EAAA;AAAA,IACvB,CAACsB,MAAiB,KAAK,eAAeA;AAAA,IACtC;AAAA,EACD,GACK,KAAA,QAAQL,QAAKjB,CAAkB,EAAA,OAAO,CAACY,MAAW,KAAK,SAASA,GAAQ,eAAe,GACvF,KAAA,QAAQK,QAAKjB,CAAkB,EAAA,MAAM,CAACuB,MAAU,KAAK,QAAQA,GAAO,cAAc,GAClF,KAAA,QAAQN,QAAKjB,CAAkB,EAAA,OAAO,CAACwB,MAAW,KAAK,SAASA,GAAQ,eAAe;AAC7F;AAqBArB,IAAqB,SAACsB,GAA0D;AAC/E,EAAAR,EAAA,MAAKjB,CAAmB,GAAA,QAAQyB,EAAM,OAAO,SAAS,EAAE,GACxDR,EAAA,MAAKjB,CAAmB,GAAA,SAASyB,EAAM,OAAO,SAAS,EAAE;AAC1D;AAEArB,IAAoB,SAACqB,GAAoD;AACxE,EAAAR,EAAA,MAAKjB,IAAmB,eAAeyB,EAAM,OAAO,MAAM,cAAc,EAAE;AAC3E;AAlEYpB,EAmGI,SAAS;AAAA,EACxBqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoDD;AAtJQC,EAAA;AAAA,EADPC,EAAM;AAAA,GADKvB,EAEJ,WAAA,SAAA,CAAA;AAGAsB,EAAA;AAAA,EADPC,EAAM;AAAA,GAJKvB,EAKJ,WAAA,gBAAA,CAAA;AAGAsB,EAAA;AAAA,EADPC,EAAM;AAAA,GAPKvB,EAQJ,WAAA,UAAA,CAAA;AAGAsB,EAAA;AAAA,EADPC,EAAM;AAAA,GAVKvB,EAWJ,WAAA,SAAA,CAAA;AAGAsB,EAAA;AAAA,EADPC,EAAM;AAAA,GAbKvB,EAcJ,WAAA,UAAA,CAAA;AAdIA,IAANsB,EAAA;AAAA,EADNE,EAAc,kCAAkC;AAAA,GACpCxB,CAAA;ACON,MAAMyB,UACJC,EAET;AAAA,EACC,YAAYC,GAAyB;AACpC,UAAMA,GAAM;AAAA,MACX,gBAAgBC;AAAA,MAChB,YAAYC;AAAA,MACZ,uBAAuBC;AAAA,IAAA,CACvB,GAED,KAAK,OAAO,UAAU;AAAA,MACrB;AAAA,QACC,MAAM;AAAA,QACN,WAAW9B;AAAA,QACX,OAAO,OAAO+B,GAAYC,MAAS;AAC5B,gBAAAC,IAAmBD,EAAK,MAAM,OAAO,kBACrCE,IAAeF,EAAK,MAAM,OAAO,iBAAiB,SAAS,OAAOA,EAAK,MAAM,OAAO,cACpFG,IAAyB,EAAE,YAAYF,GAAkB,QAAQC,EAAa;AACpF,gBAAM,KAAK,eAAe,EAAE,QAAAC,GAAQ,GAEhC,IAAAC;AAAA,YACH;AAAA,YACA;AAAA,YACA,KAAK,eAAA,EAAiB,WAAY,cAAc,iBAAiB;AAAA,UAClE;AAAA,QAAA;AAAA,MAEF;AAAA,MACA;AAAA,QACC,MAAM;AAAA,QACN,WAAWpC;AAAA,QACX,OAAO,CAAC+B,GAAYC,MAAS;AACtB,gBAAAK,IAASL,EAAK,MAAM,OAAO;AACjC,eAAK,KAAKK,CAAM;AAAA,QAAA;AAAA,MACjB;AAAA,IACD,CACA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUF,IACCC,GACAC,GACC;AACD,SAAK,UAAU,uBAAuB,EAAE,CAACD,CAAY,GAAGC,GAAO;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQhE,MAAM,OAAOJ,GAAwB;AAC/B,SAAA,eAAe,EAAE,QAAAA,GAAQ;AAAA,EAAA;AAEhC;"}