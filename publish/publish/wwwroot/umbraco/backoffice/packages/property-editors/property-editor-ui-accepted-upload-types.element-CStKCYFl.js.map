{"version":3,"file":"property-editor-ui-accepted-upload-types.element-CStKCYFl.js","sources":["../../../src/packages/property-editors/accepted-types/property-editor-ui-accepted-upload-types.element.ts"],"sourcesContent":["import { UmbPropertyEditorUIMultipleTextStringElement } from '../multiple-text-string/property-editor-ui-multiple-text-string.element.js';\r\nimport { css, customElement, html, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTemporaryFileConfigRepository } from '@umbraco-cms/backoffice/temporary-file';\r\nimport type { UmbPropertyEditorUiElement } from '@umbraco-cms/backoffice/property-editor';\r\nimport type { UmbTemporaryFileConfigurationModel } from '@umbraco-cms/backoffice/temporary-file';\r\n\r\n/**\r\n * @element umb-property-editor-ui-accepted-upload-types\r\n */\r\n@customElement('umb-property-editor-ui-accepted-upload-types')\r\nexport class UmbPropertyEditorUIAcceptedUploadTypesElement\r\n\textends UmbPropertyEditorUIMultipleTextStringElement\r\n\timplements UmbPropertyEditorUiElement\r\n{\r\n\t#temporaryFileConfigRepository = new UmbTemporaryFileConfigRepository(this);\r\n\r\n\t@state()\r\n\tprotected _acceptedTypes: string[] = [];\r\n\r\n\t@state()\r\n\tprotected _disallowedTypes: string[] = [];\r\n\r\n\t@state()\r\n\tprotected _maxFileSize?: number | null;\r\n\r\n\toverride async connectedCallback() {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\tawait this.#temporaryFileConfigRepository.initialized;\r\n\t\tthis.observe(this.#temporaryFileConfigRepository.all(), (config) => {\r\n\t\t\tif (!config) return;\r\n\r\n\t\t\tthis.#addValidators(config);\r\n\r\n\t\t\tthis._acceptedTypes = config.allowedUploadedFileExtensions;\r\n\t\t\tthis._disallowedTypes = config.disallowedUploadedFilesExtensions;\r\n\t\t\tthis._maxFileSize = config.maxFileSize ? config.maxFileSize * 1024 : null;\r\n\t\t});\r\n\t}\r\n\r\n\t#addValidators(config: UmbTemporaryFileConfigurationModel) {\r\n\t\tconst inputElement = this.shadowRoot?.querySelector('umb-input-multiple-text-string');\r\n\t\tinputElement?.addValidator(\r\n\t\t\t'badInput',\r\n\t\t\t() => {\r\n\t\t\t\tlet message = this.localize.term('validation_invalidExtensions');\r\n\t\t\t\tif (config.allowedUploadedFileExtensions.length) {\r\n\t\t\t\t\tmessage += `<br>${this.localize.term('validation_allowedExtensions')} ${config.allowedUploadedFileExtensions.join(', ')}`;\r\n\t\t\t\t}\r\n\t\t\t\tif (config.disallowedUploadedFilesExtensions.length) {\r\n\t\t\t\t\tmessage += `<br>${this.localize.term('validation_disallowedExtensions')} ${config.disallowedUploadedFilesExtensions.join(', ')}`;\r\n\t\t\t\t}\r\n\t\t\t\treturn message;\r\n\t\t\t},\r\n\t\t\t() => {\r\n\t\t\t\tconst extensions = inputElement?.items;\r\n\t\t\t\tif (!extensions) return false;\r\n\t\t\t\tif (\r\n\t\t\t\t\tconfig.allowedUploadedFileExtensions.length &&\r\n\t\t\t\t\t!config.allowedUploadedFileExtensions.some((ext) => extensions.includes(ext))\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (config.disallowedUploadedFilesExtensions.some((ext) => extensions.includes(ext))) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`${super.render()}`;\r\n\t}\r\n\r\n\tstatic override readonly styles = [\r\n\t\tcss`\r\n\t\t\t#notice {\r\n\t\t\t\t--uui-box-default-padding: var(--uui-size-space-4);\r\n\t\t\t\t--uui-box-header-padding: var(--uui-size-space-4);\r\n\t\t\t\t--uui-color-divider-standalone: var(--uui-color-warning-standalone);\r\n\r\n\t\t\t\tborder: 1px solid var(--uui-color-divider-standalone);\r\n\t\t\t\tbackground-color: var(--uui-color-warning);\r\n\t\t\t\tcolor: var(--uui-color-warning-contrast);\r\n\t\t\t\tmargin-bottom: var(--uui-size-layout-1);\r\n\r\n\t\t\t\tp {\r\n\t\t\t\t\tmargin: 0.5rem 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbPropertyEditorUIAcceptedUploadTypesElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-accepted-upload-types': UmbPropertyEditorUIAcceptedUploadTypesElement;\r\n\t}\r\n}\r\n"],"names":["_temporaryFileConfigRepository","_UmbPropertyEditorUIAcceptedUploadTypesElement_instances","addValidators_fn","UmbPropertyEditorUIAcceptedUploadTypesElement","UmbPropertyEditorUIMultipleTextStringElement","__privateAdd","UmbTemporaryFileConfigRepository","__privateGet","config","__privateMethod","html","inputElement","message","extensions","ext","css","__decorateClass","state","customElement","UmbPropertyEditorUIAcceptedUploadTypesElement$1"],"mappings":";;;;;;;;;+TAAAA,GAAAC,GAAAC;AAUa,IAAAC,IAAN,cACEC,EAET;AAAA,EAHO,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAJ,CAAA,GAI2BI,EAAA,MAAAL,GAAA,IAAIM,EAAiC,IAAI,CAAA,GAG1E,KAAU,iBAA2B,CAAC,GAGtC,KAAU,mBAA6B,CAAC;AAAA,EAAA;AAAA,EAKxC,MAAe,oBAAoB;AAClC,UAAM,kBAAkB,GAExB,MAAMC,QAAKP,CAA+B,EAAA,aAC1C,KAAK,QAAQO,EAAK,MAAAP,CAAA,EAA+B,IAAI,GAAG,CAACQ,MAAW;AACnE,MAAKA,MAELC,EAAA,MAAKR,MAAL,KAAoB,MAAAO,CAAA,GAEpB,KAAK,iBAAiBA,EAAO,+BAC7B,KAAK,mBAAmBA,EAAO,mCAC/B,KAAK,eAAeA,EAAO,cAAcA,EAAO,cAAc,OAAO;AAAA,IAAA,CACrE;AAAA,EAAA;AAAA,EAkCO,SAAS;AACV,WAAAE,IAAO,MAAM,OAAQ,CAAA;AAAA,EAAA;AAqB9B;AA/ECV,IAAA,oBAAA,QAAA;AAJMC,IAAA,oBAAA,QAAA;AA8BNC,IAAc,SAACM,GAA4C;AAC1D,QAAMG,IAAe,KAAK,YAAY,cAAc,gCAAgC;AACtE,EAAAA,GAAA;AAAA,IACb;AAAA,IACA,MAAM;AACL,UAAIC,IAAU,KAAK,SAAS,KAAK,8BAA8B;AAC3D,aAAAJ,EAAO,8BAA8B,WAC7BI,KAAA,OAAO,KAAK,SAAS,KAAK,8BAA8B,CAAC,IAAIJ,EAAO,8BAA8B,KAAK,IAAI,CAAC,KAEpHA,EAAO,kCAAkC,WACjCI,KAAA,OAAO,KAAK,SAAS,KAAK,iCAAiC,CAAC,IAAIJ,EAAO,kCAAkC,KAAK,IAAI,CAAC,KAExHI;AAAA,IACR;AAAA,IACA,MAAM;AACL,YAAMC,IAAaF,GAAc;AAC7B,aAACE,IAEJ,GAAAL,EAAO,8BAA8B,UACrC,CAACA,EAAO,8BAA8B,KAAK,CAACM,MAAQD,EAAW,SAASC,CAAG,CAAC,KAIzEN,EAAO,kCAAkC,KAAK,CAACM,MAAQD,EAAW,SAASC,CAAG,CAAC,KAP3D;AAAA,IAUjB;AAAA,EAET;AACD;AA3DYX,EAiEa,SAAS;AAAA,EACjCY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBD;AA3EUC,EAAA;AAAA,EADTC,EAAM;AAAA,GANKd,EAOF,WAAA,kBAAA,CAAA;AAGAa,EAAA;AAAA,EADTC,EAAM;AAAA,GATKd,EAUF,WAAA,oBAAA,CAAA;AAGAa,EAAA;AAAA,EADTC,EAAM;AAAA,GAZKd,EAaF,WAAA,gBAAA,CAAA;AAbEA,IAANa,EAAA;AAAA,EADNE,EAAc,8CAA8C;AAAA,GAChDf,CAAA;AAqFb,MAAAgB,IAAehB;"}