{"version":3,"file":"stylesheet-rich-text-rule-workspace-view.element-BKlYv-Jo.js","sources":["../../../src/packages/templating/stylesheets/workspace/views/rich-text-rule/stylesheet-rich-text-rule-workspace-view.element.ts"],"sourcesContent":["import type { UmbStylesheetRule } from '../../../types.js';\r\nimport type { UmbStylesheetRuleInputElement } from '../../../global-components/index.js';\r\nimport { UmbStylesheetRuleManager } from '../../../utils/index.js';\r\nimport { UMB_STYLESHEET_WORKSPACE_CONTEXT } from '../../stylesheet-workspace.context-token.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\n\r\n@customElement('umb-stylesheet-rich-text-rule-workspace-view')\r\nexport class UmbStylesheetRichTextRuleWorkspaceViewElement extends UmbLitElement {\r\n\t@state()\r\n\t_rules: UmbStylesheetRule[] = [];\r\n\r\n\t#context?: typeof UMB_STYLESHEET_WORKSPACE_CONTEXT.TYPE;\r\n\t#stylesheetRuleManager = new UmbStylesheetRuleManager();\r\n\t#stylesheetContent = '';\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_STYLESHEET_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis.#context = context;\r\n\t\t\tthis.#observeContent();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeContent() {\r\n\t\tif (!this.#context?.content) return;\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.content,\r\n\t\t\t(content) => {\r\n\t\t\t\tthis.#stylesheetContent = content || '';\r\n\t\t\t\tthis.#extractRules(content);\r\n\t\t\t},\r\n\t\t\t'umbStylesheetContentObserver',\r\n\t\t);\r\n\t}\r\n\r\n\t#extractRules(content: string | undefined) {\r\n\t\tif (content) {\r\n\t\t\tconst rules = this.#stylesheetRuleManager.extractRules(content);\r\n\t\t\tthis._rules = [...rules];\r\n\t\t} else {\r\n\t\t\tthis._rules = [];\r\n\t\t}\r\n\t}\r\n\r\n\t#onRuleChange(event: UmbChangeEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tconst target = event.target as UmbStylesheetRuleInputElement;\r\n\t\tconst rules = target.rules;\r\n\t\tconst newContent = this.#stylesheetRuleManager.insertRules(this.#stylesheetContent, rules);\r\n\t\tthis.#context?.setContent(newContent);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`<uui-box headline=\"Rich text editor styles\">\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tdescription=\"Define the styles that should be available in the rich text editor for this stylesheet.\">\r\n\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t<umb-stylesheet-rule-input .rules=${this._rules} @change=${this.#onRuleChange}></umb-stylesheet-rule-input>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t</uui-box>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\tuui-box {\r\n\t\t\t\tmargin: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbStylesheetRichTextRuleWorkspaceViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-stylesheet-rich-text-rule-workspace-view': UmbStylesheetRichTextRuleWorkspaceViewElement;\r\n\t}\r\n}\r\n"],"names":["_context","_stylesheetRuleManager","_stylesheetContent","_UmbStylesheetRichTextRuleWorkspaceViewElement_instances","observeContent_fn","extractRules_fn","onRuleChange_fn","UmbStylesheetRichTextRuleWorkspaceViewElement","UmbLitElement","__privateAdd","UmbStylesheetRuleManager","UMB_STYLESHEET_WORKSPACE_CONTEXT","context","__privateSet","__privateMethod","html","__privateGet","content","rules","event","newContent","UmbTextStyles","css","__decorateClass","state","customElement","UmbStylesheetRichTextRuleWorkspaceViewElement$1"],"mappings":";;;;;;;;;;;wXAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAUa,IAAAC,IAAN,cAA4DC,EAAc;AAAA,EAQhF,cAAc;AACP,UAAA,GATDC,EAAA,MAAAN,CAAA,GAEN,KAAA,SAA8B,CAAC,GAE/BM,EAAA,MAAAT,CAAA,GACAS,EAAA,MAAAR,GAAyB,IAAIS,EAAyB,CAAA,GACjCD,EAAA,MAAAP,GAAA,EAAA,GAKf,KAAA,eAAeS,GAAkC,CAACC,MAAY;AAClE,MAAAC,EAAA,MAAKb,GAAWY,CAAA,GAChBE,EAAA,MAAKX,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,IAAA,CACA;AAAA,EAAA;AAAA,EAgCO,SAAS;AACV,WAAAW;AAAA;AAAA;AAAA;AAAA,yCAIgC,KAAK,MAAM,YAAYD,EAAA,MAAKX,GAAaG,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA,EAAA;AAmBlF;AAlECN,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AANMC,IAAA,oBAAA,QAAA;AAiBNC,IAAe,WAAG;AACb,EAACY,EAAK,MAAAhB,CAAA,GAAU,WACf,KAAA;AAAA,IACJgB,QAAKhB,CAAS,EAAA;AAAA,IACd,CAACiB,MAAY;AACZ,MAAAJ,EAAA,MAAKX,GAAqBe,KAAW,EAAA,GACrCH,EAAA,MAAKX,MAAL,KAAmB,MAAAc,CAAA;AAAA,IACpB;AAAA,IACA;AAAA,EACD;AACD;AAEAZ,IAAa,SAACY,GAA6B;AAC1C,MAAIA,GAAS;AACZ,UAAMC,IAAQF,EAAA,MAAKf,CAAuB,EAAA,aAAagB,CAAO;AACzD,SAAA,SAAS,CAAC,GAAGC,CAAK;AAAA,EAAA;AAEvB,SAAK,SAAS,CAAC;AAEjB;AAEAZ,IAAa,SAACa,GAAuB;AACpC,EAAAA,EAAM,gBAAgB;AAEtB,QAAMD,IADSC,EAAM,OACA,OACfC,IAAaJ,EAAK,MAAAf,CAAA,EAAuB,YAAYe,EAAA,MAAKd,IAAoBgB,CAAK;AACpF,EAAAF,EAAA,MAAAhB,CAAA,GAAU,WAAWoB,CAAU;AACrC;AA5CYb,EAyDI,SAAS;AAAA,EACxBc;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUD;AAnEAC,EAAA;AAAA,EADCC,EAAM;AAAA,GADKjB,EAEZ,WAAA,UAAA,CAAA;AAFYA,IAANgB,EAAA;AAAA,EADNE,EAAc,8CAA8C;AAAA,GAChDlB,CAAA;AAwEb,MAAAmB,IAAenB;"}