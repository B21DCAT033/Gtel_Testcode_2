{"version":3,"file":"stylesheet-rule-manager-kXMtc4LQ.js","sources":["../../../src/packages/templating/stylesheets/utils/stylesheet-rule-manager.ts"],"sourcesContent":["import type { UmbStylesheetRule } from '../types.js';\r\n\r\nexport class UmbStylesheetRuleManager {\r\n\t#umbRuleRegex = /\\/\\*\\*\\s*umb_name:\\s*(?<name>[^*\\r\\n]*?)\\s*\\*\\/\\s*(?<selector>[^,{]*?)\\s*{\\s*(?<styles>.*?)\\s*}/gis;\r\n\r\n\t/**\r\n\t * Extracts umbraco rules from a stylesheet content\r\n\t * @param {string} stylesheetContent\r\n\t * @returns {*}\r\n\t * @memberof UmbStylesheetRuleManager\r\n\t */\r\n\textractRules(stylesheetContent: string): Array<UmbStylesheetRule> {\r\n\t\tconst regex = this.#umbRuleRegex;\r\n\t\tif (!stylesheetContent) throw Error('No Stylesheet content');\r\n\t\treturn [...stylesheetContent.matchAll(regex)].map((match) => {\r\n\t\t\tconst rule: UmbStylesheetRule = {\r\n\t\t\t\tname: match.groups?.name || '',\r\n\t\t\t\tselector: match.groups?.selector || '',\r\n\t\t\t\tstyles: match.groups?.styles || '',\r\n\t\t\t};\r\n\t\t\treturn rule;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Inserts umbraco rules into stylesheet content\r\n\t * @param {string} stylesheetContent\r\n\t * @param {UmbStylesheetRule[]} rules\r\n\t * @returns {*}\r\n\t * @memberof UmbStylesheetRuleManager\r\n\t */\r\n\tinsertRules(stylesheetContent: string, rules: Array<any>): string {\r\n\t\tconst regex = this.#umbRuleRegex;\r\n\t\tif (!stylesheetContent && !rules) return '';\r\n\r\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n\t\t//@ts-ignore\r\n\t\tconst cleanedContent = stylesheetContent?.replaceAll(regex, '');\r\n\t\tconst newContent = `\r\n      ${cleanedContent.replace(/[\\r\\n]+$/, '')}\r\n      ${rules\r\n\t\t\t\t?.map(\r\n\t\t\t\t\t(rule) => `\r\n/**umb_name:${rule.name}*/\r\n${rule.selector} {\r\n\t${rule.styles ?? ''}\r\n}\r\n`,\r\n\t\t\t\t)\r\n\t\t\t\t.join('')}`;\r\n\t\treturn newContent.trim();\r\n\t}\r\n}\r\n"],"names":["UmbStylesheetRuleManager","#umbRuleRegex","stylesheetContent","regex","match","rules","rule"],"mappings":"AAEO,MAAMA,EAAyB;AAAA,EACrCC,KAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQhB,aAAaC,GAAqD;AACjE,UAAMC,IAAQ,KAAKF;AACnB,QAAI,CAACC,EAAyB,OAAA,MAAM,uBAAuB;AACpD,WAAA,CAAC,GAAGA,EAAkB,SAASC,CAAK,CAAC,EAAE,IAAI,CAACC,OAClB;AAAA,MAC/B,MAAMA,EAAM,QAAQ,QAAQ;AAAA,MAC5B,UAAUA,EAAM,QAAQ,YAAY;AAAA,MACpC,QAAQA,EAAM,QAAQ,UAAU;AAAA,IACjC,EAEA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUF,YAAYF,GAA2BG,GAA2B;AACjE,UAAMF,IAAQ,KAAKF;AACnB,WAAI,CAACC,KAAqB,CAACG,IAAc,KAKtB;AAAA,SADIH,GAAmB,WAAWC,GAAO,EAAE,GAEzC,QAAQ,YAAY,EAAE,CAAC;AAAA,QACtCE,GACF;AAAA,MACD,CAACC,MAAS;AAAA,cACDA,EAAK,IAAI;AAAA,EACrBA,EAAK,QAAQ;AAAA,GACZA,EAAK,UAAU,EAAE;AAAA;AAAA;AAAA,IAAA,EAIf,KAAK,EAAE,CAAC,GACO,KAAK;AAAA,EAAA;AAEzB;"}