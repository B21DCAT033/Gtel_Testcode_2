{"version":3,"file":"tiny-mce-code-editor.plugin-B6ofbssc.js","sources":["../../../src/packages/tiny-mce/plugins/tiny-mce-code-editor.plugin.ts"],"sourcesContent":["import { type TinyMcePluginArguments, UmbTinyMcePluginBase } from '../components/input-tiny-mce/tiny-mce-plugin.js';\r\nimport { UmbLocalizationController } from '@umbraco-cms/backoffice/localization-api';\r\nimport { UMB_CODE_EDITOR_MODAL } from '@umbraco-cms/backoffice/code-editor';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\n\r\nexport default class UmbTinyMceCodeEditorPlugin extends UmbTinyMcePluginBase {\r\n\tconstructor(args: TinyMcePluginArguments) {\r\n\t\tsuper(args);\r\n\t\tconst localize = new UmbLocalizationController(args.host);\r\n\r\n\t\tthis.editor.ui.registry.addButton('sourcecode', {\r\n\t\t\ticon: 'sourcecode',\r\n\t\t\ttooltip: localize.term('general_viewSourceCode'),\r\n\t\t\tonAction: () => this.#showCodeEditor(),\r\n\t\t});\r\n\t}\r\n\r\n\tasync #showCodeEditor() {\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tconst modal = modalManager.open(this, UMB_CODE_EDITOR_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\theadline: 'Edit source code',\r\n\t\t\t\tcontent: this.editor.getContent() ?? '',\r\n\t\t\t\tlanguage: 'html',\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tconst value = await modal.onSubmit().catch(() => undefined);\r\n\t\tif (!value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!value.content) {\r\n\t\t\tthis.editor.resetContent();\r\n\t\t} else {\r\n\t\t\tthis.editor.setContent(value.content.toString());\r\n\t\t}\r\n\r\n\t\tthis.editor.dispatch('Change');\r\n\t}\r\n}\r\n"],"names":["UmbTinyMceCodeEditorPlugin","UmbTinyMcePluginBase","args","localize","UmbLocalizationController","#showCodeEditor","value","UMB_MODAL_MANAGER_CONTEXT","UMB_CODE_EDITOR_MODAL"],"mappings":";;;;AAKA,MAAqBA,UAAmCC,EAAqB;AAAA,EAC5E,YAAYC,GAA8B;AACzC,UAAMA,CAAI;AACV,UAAMC,IAAW,IAAIC,EAA0BF,EAAK,IAAI;AAExD,SAAK,OAAO,GAAG,SAAS,UAAU,cAAc;AAAA,MAC/C,MAAM;AAAA,MACN,SAASC,EAAS,KAAK,wBAAwB;AAAA,MAC/C,UAAU,MAAM,KAAKE,GAAgB;AAAA,IAAA,CACrC;AAAA,EAAA;AAAA,EAGF,MAAMA,KAAkB;AAUvB,UAAMC,IAAQ,OATO,MAAM,KAAK,WAAWC,CAAyB,GACzC,KAAK,MAAMC,GAAuB;AAAA,MAC5D,MAAM;AAAA,QACL,UAAU;AAAA,QACV,SAAS,KAAK,OAAO,WAAgB,KAAA;AAAA,QACrC,UAAU;AAAA,MAAA;AAAA,IACX,CACA,EAEyB,WAAW,MAAM,MAAA;AAAA,KAAe;AAC1D,IAAKF,MAIAA,EAAM,UAGV,KAAK,OAAO,WAAWA,EAAM,QAAQ,UAAU,IAF/C,KAAK,OAAO,aAAa,GAKrB,KAAA,OAAO,SAAS,QAAQ;AAAA,EAAA;AAE/B;"}