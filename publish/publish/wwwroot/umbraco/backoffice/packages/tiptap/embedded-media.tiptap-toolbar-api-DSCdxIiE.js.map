{"version":3,"file":"embedded-media.tiptap-toolbar-api-DSCdxIiE.js","sources":["../../../src/packages/tiptap/extensions/toolbar/embedded-media.tiptap-toolbar-api.ts"],"sourcesContent":["import { UmbTiptapToolbarElementApiBase } from '../base.js';\r\nimport { umbEmbeddedMedia } from '@umbraco-cms/backoffice/external/tiptap';\r\nimport { UMB_EMBEDDED_MEDIA_MODAL } from '@umbraco-cms/backoffice/embedded-media';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport type { Editor } from '@umbraco-cms/backoffice/external/tiptap';\r\n\r\nexport default class UmbTiptapToolbarEmbeddedMediaExtensionApi extends UmbTiptapToolbarElementApiBase {\r\n\toverride isActive = (editor: Editor) => editor.isActive(umbEmbeddedMedia.name) === true;\r\n\r\n\toverride async execute(editor?: Editor) {\r\n\t\tconst data = {\r\n\t\t\tconstrain: false,\r\n\t\t\theight: 240,\r\n\t\t\twidth: 360,\r\n\t\t\turl: '',\r\n\t\t};\r\n\r\n\t\tconst attrs = editor?.getAttributes(umbEmbeddedMedia.name);\r\n\t\tif (attrs) {\r\n\t\t\tdata.constrain = attrs['data-embed-constrain'];\r\n\t\t\tdata.height = attrs['data-embed-height'];\r\n\t\t\tdata.width = attrs['data-embed-width'];\r\n\t\t\tdata.url = attrs['data-embed-url'];\r\n\t\t}\r\n\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tconst modalHandler = modalManager.open(this, UMB_EMBEDDED_MEDIA_MODAL, { data });\r\n\r\n\t\tif (!modalHandler) return;\r\n\r\n\t\tconst result = await modalHandler.onSubmit().catch(() => undefined);\r\n\t\tif (!result) return;\r\n\r\n\t\teditor?.commands.setEmbeddedMedia({\r\n\t\t\tmarkup: result.markup,\r\n\t\t\turl: result.url,\r\n\t\t\tconstrain: result.constrain,\r\n\t\t\theight: result.height?.toString(),\r\n\t\t\twidth: result.width?.toString(),\r\n\t\t});\r\n\t}\r\n}\r\n"],"names":["UmbTiptapToolbarEmbeddedMediaExtensionApi","UmbTiptapToolbarElementApiBase","editor","umbEmbeddedMedia","data","attrs","modalHandler","UMB_MODAL_MANAGER_CONTEXT","UMB_EMBEDDED_MEDIA_MODAL","result"],"mappings":";;;;AAMA,MAAqBA,UAAkDC,EAA+B;AAAA,EAAtG,cAAA;AAAA,UAAA,GAAA,SAAA,GACC,KAAS,WAAW,CAACC,MAAmBA,EAAO,SAASC,EAAiB,IAAI,MAAM;AAAA,EAAA;AAAA,EAEnF,MAAe,QAAQD,GAAiB;AACvC,UAAME,IAAO;AAAA,MACZ,WAAW;AAAA,MACX,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,KAAK;AAAA,IACN,GAEMC,IAAQH,GAAQ,cAAcC,EAAiB,IAAI;AACzD,IAAIE,MACED,EAAA,YAAYC,EAAM,sBAAsB,GACxCD,EAAA,SAASC,EAAM,mBAAmB,GAClCD,EAAA,QAAQC,EAAM,kBAAkB,GAChCD,EAAA,MAAMC,EAAM,gBAAgB;AAIlC,UAAMC,KADe,MAAM,KAAK,WAAWC,CAAyB,GAClC,KAAK,MAAMC,GAA0B,EAAE,MAAAJ,GAAM;AAE/E,QAAI,CAACE,EAAc;AAEnB,UAAMG,IAAS,MAAMH,EAAa,WAAW,MAAM,MAAA;AAAA,KAAe;AAClE,IAAKG,KAELP,GAAQ,SAAS,iBAAiB;AAAA,MACjC,QAAQO,EAAO;AAAA,MACf,KAAKA,EAAO;AAAA,MACZ,WAAWA,EAAO;AAAA,MAClB,QAAQA,EAAO,QAAQ,SAAS;AAAA,MAChC,OAAOA,EAAO,OAAO,SAAS;AAAA,IAAA,CAC9B;AAAA,EAAA;AAEH;"}