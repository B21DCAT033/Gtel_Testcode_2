{"version":3,"file":"property-editor-ui-tiptap-toolbar-configuration.element-B8SmBT_q.js","sources":["../../../src/packages/tiptap/property-editors/tiptap/contexts/tiptap-toolbar-configuration.context.ts","../../../src/packages/tiptap/property-editors/tiptap/components/property-editor-ui-tiptap-toolbar-configuration.element.ts"],"sourcesContent":["import type { UmbTiptapToolbarValue } from '../../../components/types.js';\r\nimport type {\r\n\tUmbTiptapToolbarExtension,\r\n\tUmbTiptapToolbarGroupViewModel,\r\n\tUmbTiptapToolbarRowViewModel,\r\n} from '../types.js';\r\nimport { UMB_TIPTAP_TOOLBAR_CONFIGURATION_CONTEXT } from './tiptap-toolbar-configuration.context-token.js';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UmbArrayState, UmbBooleanState } from '@umbraco-cms/backoffice/observable-api';\r\nimport { UmbContextBase } from '@umbraco-cms/backoffice/class-api';\r\nimport { UmbId } from '@umbraco-cms/backoffice/id';\r\nimport { UMB_PROPERTY_DATASET_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\n\r\nexport class UmbTiptapToolbarConfigurationContext extends UmbContextBase<UmbTiptapToolbarConfigurationContext> {\r\n\t#extensions = new UmbArrayState<UmbTiptapToolbarExtension>([], (x) => x.alias);\r\n\tpublic readonly extensions = this.#extensions.asObservable();\r\n\r\n\t#reload = new UmbBooleanState(false);\r\n\tpublic readonly reload = this.#reload.asObservable();\r\n\r\n\t#extensionsEnabled = new Set<string>();\r\n\r\n\t#extensionsInUse = new Set<string>();\r\n\r\n\t#lookup?: Map<string, UmbTiptapToolbarExtension>;\r\n\r\n\t#toolbar = new UmbArrayState<UmbTiptapToolbarRowViewModel>([], (x) => x.unique);\r\n\tpublic readonly toolbar = this.#toolbar.asObservable();\r\n\r\n\t/** @deprecated This will be removed in Umbraco 16. */\r\n\t#tinyMceToolbarMapping: Record<string, string | null> = {\r\n\t\tundo: 'Umb.Tiptap.Toolbar.Undo',\r\n\t\tredo: 'Umb.Tiptap.Toolbar.Redo',\r\n\t\tcut: null,\r\n\t\tcopy: null,\r\n\t\tpaste: null,\r\n\t\tstyles: 'Umb.Tiptap.Toolbar.StyleSelect',\r\n\t\tfontname: 'Umb.Tiptap.Toolbar.FontFamily',\r\n\t\tfontfamily: 'Umb.Tiptap.Toolbar.FontFamily',\r\n\t\tfontsize: 'Umb.Tiptap.Toolbar.FontSize',\r\n\t\tforecolor: null,\r\n\t\tbackcolor: null,\r\n\t\tblockquote: 'Umb.Tiptap.Toolbar.Blockquote',\r\n\t\tformatblock: null,\r\n\t\tremoveformat: 'Umb.Tiptap.Toolbar.ClearFormatting',\r\n\t\tbold: 'Umb.Tiptap.Toolbar.Bold',\r\n\t\titalic: 'Umb.Tiptap.Toolbar.Italic',\r\n\t\tunderline: 'Umb.Tiptap.Toolbar.Underline',\r\n\t\tstrikethrough: 'Umb.Tiptap.Toolbar.Strike',\r\n\t\talignleft: 'Umb.Tiptap.Toolbar.TextAlignLeft',\r\n\t\taligncenter: 'Umb.Tiptap.Toolbar.TextAlignCenter',\r\n\t\talignright: 'Umb.Tiptap.Toolbar.TextAlignRight',\r\n\t\talignjustify: 'Umb.Tiptap.Toolbar.TextAlignJustify',\r\n\t\tbullist: 'Umb.Tiptap.Toolbar.BulletList',\r\n\t\tnumlist: 'Umb.Tiptap.Toolbar.OrderedList',\r\n\t\toutdent: null,\r\n\t\tindent: null,\r\n\t\tanchor: null,\r\n\t\ttable: 'Umb.Tiptap.Toolbar.Table',\r\n\t\thr: 'Umb.Tiptap.Toolbar.HorizontalRule',\r\n\t\tsubscript: 'Umb.Tiptap.Toolbar.Subscript',\r\n\t\tsuperscript: 'Umb.Tiptap.Toolbar.Superscript',\r\n\t\tcharmap: null,\r\n\t\trtl: null,\r\n\t\tltr: null,\r\n\t\tlink: 'Umb.Tiptap.Toolbar.Link',\r\n\t\tunlink: 'Umb.Tiptap.Toolbar.Unlink',\r\n\t\tsourcecode: 'Umb.Tiptap.Toolbar.SourceEditor',\r\n\t\tumbmediapicker: 'Umb.Tiptap.Toolbar.MediaPicker',\r\n\t\tumbembeddialog: 'Umb.Tiptap.Toolbar.EmbeddedMedia',\r\n\t\tumbblockpicker: 'Umb.Tiptap.Toolbar.BlockPicker',\r\n\t};\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_TIPTAP_TOOLBAR_CONFIGURATION_CONTEXT);\r\n\r\n\t\tthis.observe(umbExtensionsRegistry.byType('tiptapToolbarExtension'), (extensions) => {\r\n\t\t\tconst _extensions = extensions.map((ext) => ({\r\n\t\t\t\talias: ext.alias,\r\n\t\t\t\tlabel: ext.meta.label,\r\n\t\t\t\ticon: ext.meta.icon,\r\n\t\t\t\tdependencies: ext.forExtensions,\r\n\t\t\t}));\r\n\r\n\t\t\tthis.#extensions.setValue(_extensions);\r\n\r\n\t\t\tthis.#lookup = new Map(_extensions.map((ext) => [ext.alias, ext]));\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_PROPERTY_DATASET_CONTEXT, async (dataset) => {\r\n\t\t\tthis.observe(\r\n\t\t\t\tawait dataset.propertyValueByAlias<Array<string>>('extensions'),\r\n\t\t\t\t(extensions) => {\r\n\t\t\t\t\tif (extensions) {\r\n\t\t\t\t\t\tthis.#extensionsEnabled.clear();\r\n\t\t\t\t\t\tthis.#reload.setValue(false);\r\n\r\n\t\t\t\t\t\tthis.#extensions\r\n\t\t\t\t\t\t\t.getValue()\r\n\t\t\t\t\t\t\t.filter((x) => !x.dependencies || x.dependencies.every((z) => extensions.includes(z)))\r\n\t\t\t\t\t\t\t.map((x) => x.alias)\r\n\t\t\t\t\t\t\t.forEach((alias) => this.#extensionsEnabled.add(alias));\r\n\r\n\t\t\t\t\t\tthis.#reload.setValue(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'_observeExtensions',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic cloneToolbarValue(value?: UmbTiptapToolbarValue | null): UmbTiptapToolbarValue {\r\n\t\tif (!this.isValidToolbarValue(value)) return [[[]]];\r\n\t\treturn value.map((row) => row.map((group) => [...group]));\r\n\t}\r\n\r\n\tpublic filterExtensions(query: string): Array<UmbTiptapToolbarExtension> {\r\n\t\treturn this.#extensions\r\n\t\t\t.getValue()\r\n\t\t\t.filter((ext) => ext.alias?.toLowerCase().includes(query) || ext.label?.toLowerCase().includes(query));\r\n\t}\r\n\r\n\tpublic getExtensionByAlias(alias: string): UmbTiptapToolbarExtension | undefined {\r\n\t\treturn this.#lookup?.get(alias);\r\n\t}\r\n\r\n\tpublic isExtensionEnabled(alias: string): boolean {\r\n\t\treturn this.#extensionsEnabled.has(alias);\r\n\t}\r\n\r\n\tpublic isExtensionInUse(alias: string): boolean {\r\n\t\treturn this.#extensionsInUse.has(alias);\r\n\t}\r\n\r\n\tpublic isValidToolbarValue(value: unknown): value is UmbTiptapToolbarValue {\r\n\t\tif (!Array.isArray(value)) return false;\r\n\t\tfor (const row of value) {\r\n\t\t\tif (!Array.isArray(row)) return false;\r\n\t\t\tfor (const group of row) {\r\n\t\t\t\tif (!Array.isArray(group)) return false;\r\n\t\t\t\tfor (const alias of group) {\r\n\t\t\t\t\tif (typeof alias !== 'string') return false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic insertToolbarItem(alias: string, to: [number, number, number]) {\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\r\n\t\tconst [rowIndex, groupIndex, itemIndex] = to;\r\n\r\n\t\tconst row = toolbar[rowIndex];\r\n\t\tconst rowData = [...row.data];\r\n\t\tconst group = rowData[groupIndex];\r\n\t\tconst items = [...group.data];\r\n\r\n\t\titems.splice(itemIndex, 0, alias);\r\n\t\tthis.#extensionsInUse.add(alias);\r\n\r\n\t\trowData[groupIndex] = { unique: group.unique, data: items };\r\n\t\ttoolbar[rowIndex] = { unique: row.unique, data: rowData };\r\n\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\tpublic insertToolbarGroup(rowIndex: number, groupIndex: number) {\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\t\tconst row = toolbar[rowIndex];\r\n\t\tconst groups = [...row.data];\r\n\t\tgroups.splice(groupIndex, 0, { unique: UmbId.new(), data: [] });\r\n\t\ttoolbar[rowIndex] = { unique: row.unique, data: groups };\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\tpublic insertToolbarRow(rowIndex: number) {\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\t\ttoolbar.splice(rowIndex, 0, { unique: UmbId.new(), data: [{ unique: UmbId.new(), data: [] }] });\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {UmbTiptapToolbarValue | Array<string> | null} value - The value to migrate.\r\n\t * @returns {UmbTiptapToolbarValue} The migrated value.\r\n\t * @deprecated This will be removed in Umbraco 16.\r\n\t */\r\n\tpublic migrateTinyMceToolbar(value?: UmbTiptapToolbarValue | Array<string> | null): UmbTiptapToolbarValue {\r\n\t\tif (this.isValidToolbarValue(value)) return value;\r\n\r\n\t\tconst items: Array<string> = [];\r\n\r\n\t\tif (Array.isArray(value) && value.length > 0 && typeof value[0] === 'string') {\r\n\t\t\tfor (const alias of value) {\r\n\t\t\t\tconst mapping = this.#tinyMceToolbarMapping[alias];\r\n\t\t\t\tif (mapping) {\r\n\t\t\t\t\titems.push(mapping);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn [[items]];\r\n\t}\r\n\r\n\tpublic moveToolbarItem(from: [number, number, number], to: [number, number, number]) {\r\n\t\tconst [fromRowIndex, fromGroupIndex, fromItemIndex] = from;\r\n\t\tconst [toRowIndex, toGroupIndex, toItemIndex] = to;\r\n\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\r\n\t\tconst fromRow = toolbar[fromRowIndex];\r\n\t\tconst fromRowData = [...fromRow.data];\r\n\t\tconst fromGroup = fromRowData[fromGroupIndex];\r\n\t\tconst fromItems = [...fromGroup.data];\r\n\r\n\t\tconst toBeMoved = fromItems.splice(fromItemIndex, 1);\r\n\r\n\t\tfromRowData[fromGroupIndex] = { unique: fromGroup.unique, data: fromItems };\r\n\t\ttoolbar[fromRowIndex] = { unique: fromRow.unique, data: fromRowData };\r\n\r\n\t\tconst toRow = toolbar[toRowIndex];\r\n\t\tconst toRowData = [...toRow.data];\r\n\t\tconst toGroup = toRowData[toGroupIndex];\r\n\t\tconst toItems = [...toGroup.data];\r\n\r\n\t\ttoItems.splice(toItemIndex, 0, toBeMoved[0]);\r\n\r\n\t\ttoRowData[toGroupIndex] = { unique: toGroup.unique, data: toItems };\r\n\t\ttoolbar[toRowIndex] = { unique: toRow.unique, data: toRowData };\r\n\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\tpublic removeToolbarItem(from: [number, number, number]) {\r\n\t\tconst [rowIndex, groupIndex, itemIndex] = from;\r\n\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\t\tconst row = toolbar[rowIndex];\r\n\t\tconst rowData = [...row.data];\r\n\t\tconst group = rowData[groupIndex];\r\n\t\tconst items = [...group.data];\r\n\r\n\t\tconst removed = items.splice(itemIndex, 1);\r\n\t\tremoved.forEach((alias) => this.#extensionsInUse.delete(alias));\r\n\r\n\t\trowData[groupIndex] = { unique: group.unique, data: items };\r\n\t\ttoolbar[rowIndex] = { unique: row.unique, data: rowData };\r\n\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\tpublic removeToolbarGroup(rowIndex: number, groupIndex: number) {\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\r\n\t\tif (toolbar[rowIndex].data.length > groupIndex) {\r\n\t\t\tconst row = toolbar[rowIndex];\r\n\t\t\tconst groups = [...row.data];\r\n\t\t\tconst removed = groups.splice(groupIndex, 1);\r\n\t\t\tremoved.forEach((group) => group.data.forEach((alias) => this.#extensionsInUse.delete(alias)));\r\n\t\t\ttoolbar[rowIndex] = { unique: row.unique, data: groups };\r\n\t\t}\r\n\r\n\t\t// Prevent leaving an empty group\r\n\t\tif (toolbar[rowIndex].data.length === 0) {\r\n\t\t\ttoolbar[rowIndex].data[0] = { unique: UmbId.new(), data: [] };\r\n\t\t}\r\n\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\tpublic removeToolbarRow(rowIndex: number) {\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\r\n\t\tif (toolbar.length > rowIndex) {\r\n\t\t\tconst removed = toolbar.splice(rowIndex, 1);\r\n\t\t\tremoved.forEach((row) =>\r\n\t\t\t\trow.data.forEach((group) => group.data.forEach((alias) => this.#extensionsInUse.delete(alias))),\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Prevent leaving an empty row\r\n\t\tif (toolbar.length === 0) {\r\n\t\t\ttoolbar[0] = { unique: UmbId.new(), data: [{ unique: UmbId.new(), data: [] }] };\r\n\t\t}\r\n\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\tpublic setToolbar(value?: UmbTiptapToolbarValue | null) {\r\n\t\tif (!this.isValidToolbarValue(value)) {\r\n\t\t\tvalue = [[[]]];\r\n\t\t}\r\n\r\n\t\tthis.#extensionsInUse.clear();\r\n\t\tvalue.forEach((row) => row.forEach((group) => group.forEach((alias) => this.#extensionsInUse.add(alias))));\r\n\r\n\t\tconst toolbar = value.map((row) => ({\r\n\t\t\tunique: UmbId.new(),\r\n\t\t\tdata: row.map((group) => ({ unique: UmbId.new(), data: group })),\r\n\t\t}));\r\n\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n\r\n\tpublic updateToolbarRow(rowIndex: number, groups: Array<UmbTiptapToolbarGroupViewModel>) {\r\n\t\tconst toolbar = [...this.#toolbar.getValue()];\r\n\r\n\t\tconst row = toolbar[rowIndex];\r\n\t\ttoolbar[rowIndex] = { unique: row.unique, data: groups };\r\n\r\n\t\tthis.#toolbar.setValue(toolbar);\r\n\t}\r\n}\r\n","import { UmbTiptapToolbarConfigurationContext } from '../contexts/tiptap-toolbar-configuration.context.js';\r\nimport type {\r\n\tUmbTiptapToolbarExtension,\r\n\tUmbTiptapToolbarGroupViewModel,\r\n\tUmbTiptapToolbarRowViewModel,\r\n} from '../types.js';\r\nimport type { UmbTiptapToolbarValue } from '../../../components/types.js';\r\nimport { customElement, css, html, property, repeat, state, when, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { debounce } from '@umbraco-cms/backoffice/utils';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UMB_PROPERTY_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport type { UmbPropertyEditorUiElement } from '@umbraco-cms/backoffice/property-editor';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\n@customElement('umb-property-editor-ui-tiptap-toolbar-configuration')\r\nexport class UmbPropertyEditorUiTiptapToolbarConfigurationElement\r\n\textends UmbLitElement\r\n\timplements UmbPropertyEditorUiElement\r\n{\r\n\t#context = new UmbTiptapToolbarConfigurationContext(this);\r\n\r\n\t#currentDragItem?: { alias: string; fromPos?: [number, number, number] };\r\n\r\n\t#debouncedFilter = debounce((query: string) => {\r\n\t\tthis._availableExtensions = this.#context.filterExtensions(query);\r\n\t}, 250);\r\n\r\n\t@state()\r\n\tprivate _availableExtensions: Array<UmbTiptapToolbarExtension> = [];\r\n\r\n\t@state()\r\n\tprivate _toolbar: Array<UmbTiptapToolbarRowViewModel> = [];\r\n\r\n\t@property({ attribute: false })\r\n\tset value(value: UmbTiptapToolbarValue | undefined) {\r\n\t\tif (!value) value = [[[]]];\r\n\t\tif (value === this.#value) return;\r\n\t\tthis.#value = this.#context.migrateTinyMceToolbar(value);\r\n\t}\r\n\tget value(): UmbTiptapToolbarValue | undefined {\r\n\t\treturn this.#context.cloneToolbarValue(this.#value);\r\n\t}\r\n\t#value?: UmbTiptapToolbarValue;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_PROPERTY_CONTEXT, (propertyContext) => {\r\n\t\t\tthis.observe(this.#context.extensions, (extensions) => {\r\n\t\t\t\tthis._availableExtensions = extensions;\r\n\t\t\t});\r\n\r\n\t\t\tthis.observe(this.#context.reload, (reload) => {\r\n\t\t\t\tif (reload) {\r\n\t\t\t\t\tthis.requestUpdate();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.observe(this.#context.toolbar, (toolbar) => {\r\n\t\t\t\tif (!toolbar.length) return;\r\n\t\t\t\tthis._toolbar = toolbar;\r\n\t\t\t\tthis.#value = toolbar.map((rows) => rows.data.map((groups) => [...groups.data]));\r\n\t\t\t\tpropertyContext.setValue(this.#value);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprotected override firstUpdated() {\r\n\t\tthis.#context.setToolbar(this.value);\r\n\t}\r\n\r\n\t#onClick(item: UmbTiptapToolbarExtension) {\r\n\t\tconst lastRow = (this.#value?.length ?? 1) - 1;\r\n\t\tconst lastGroup = (this.#value?.[lastRow].length ?? 1) - 1;\r\n\t\tconst lastItem = this.#value?.[lastRow][lastGroup].length ?? 0;\r\n\t\tthis.#context.insertToolbarItem(item.alias, [lastRow, lastGroup, lastItem]);\r\n\t}\r\n\r\n\t#onDragStart(event: DragEvent, alias: string, fromPos?: [number, number, number]) {\r\n\t\tevent.dataTransfer!.effectAllowed = 'move';\r\n\t\tthis.#currentDragItem = { alias, fromPos };\r\n\t}\r\n\r\n\t#onDragOver(event: DragEvent) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.dataTransfer!.dropEffect = 'move';\r\n\t}\r\n\r\n\t#onDragEnd(event: DragEvent) {\r\n\t\tevent.preventDefault();\r\n\t\tif (event.dataTransfer?.dropEffect === 'none') {\r\n\t\t\tconst { fromPos } = this.#currentDragItem ?? {};\r\n\t\t\tif (!fromPos) return;\r\n\r\n\t\t\tthis.#context.removeToolbarItem(fromPos);\r\n\t\t}\r\n\t}\r\n\r\n\t#onDrop(event: DragEvent, toPos?: [number, number, number]) {\r\n\t\tevent.preventDefault();\r\n\t\tconst { alias, fromPos } = this.#currentDragItem ?? {};\r\n\r\n\t\t// Remove item if no destination position is provided\r\n\t\tif (fromPos && !toPos) {\r\n\t\t\tthis.#context.removeToolbarItem(fromPos);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Move item if both source and destination positions are available\r\n\t\tif (fromPos && toPos) {\r\n\t\t\tthis.#context.moveToolbarItem(fromPos, toPos);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Insert item if an alias and a destination position are provided\r\n\t\tif (alias && toPos) {\r\n\t\t\tthis.#context.insertToolbarItem(alias, toPos);\r\n\t\t}\r\n\t}\r\n\r\n\t#onFilterInput(event: InputEvent & { target: HTMLInputElement }) {\r\n\t\tconst query = (event.target.value ?? '').toLocaleLowerCase();\r\n\t\tthis.#debouncedFilter(query);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`${this.#renderDesigner()} ${this.#renderAvailableItems()}`;\r\n\t}\r\n\r\n\t#renderAvailableItems() {\r\n\t\treturn html`\r\n\t\t\t<uui-box id=\"toolbox\" headline=${this.localize.term('tiptap_toobar_availableItems')}>\r\n\t\t\t\t<div slot=\"header-actions\">\r\n\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\ttype=\"search\"\r\n\t\t\t\t\t\tautocomplete=\"off\"\r\n\t\t\t\t\t\tplaceholder=${this.localize.term('placeholders_filter')}\r\n\t\t\t\t\t\t@input=${this.#onFilterInput}>\r\n\t\t\t\t\t\t<div slot=\"prepend\">\r\n\t\t\t\t\t\t\t<uui-icon name=\"search\"></uui-icon>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</uui-input>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"available-items\" dropzone=\"move\" @drop=${this.#onDrop} @dragover=${this.#onDragOver}>\r\n\t\t\t\t\t${when(\r\n\t\t\t\t\t\tthis._availableExtensions.length === 0,\r\n\t\t\t\t\t\t() =>\r\n\t\t\t\t\t\t\thtml`<umb-localize key=\"tiptap_toobar_availableItemsEmpty\"\r\n\t\t\t\t\t\t\t\t>There are no toolbar extensions to show</umb-localize\r\n\t\t\t\t\t\t\t>`,\r\n\t\t\t\t\t\t() => repeat(this._availableExtensions, (item) => this.#renderAvailableItem(item)),\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderAvailableItem(item: UmbTiptapToolbarExtension) {\r\n\t\tconst forbidden = !this.#context.isExtensionEnabled(item.alias);\r\n\t\tconst inUse = this.#context.isExtensionInUse(item.alias);\r\n\t\treturn inUse || forbidden\r\n\t\t\t? nothing\r\n\t\t\t: html`\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\tclass=${forbidden ? 'forbidden' : ''}\r\n\t\t\t\t\t\tdraggable=\"true\"\r\n\t\t\t\t\t\tlook=${forbidden ? 'placeholder' : 'outline'}\r\n\t\t\t\t\t\t?disabled=${forbidden || inUse}\r\n\t\t\t\t\t\t@click=${() => this.#onClick(item)}\r\n\t\t\t\t\t\t@dragstart=${(e: DragEvent) => this.#onDragStart(e, item.alias)}\r\n\t\t\t\t\t\t@dragend=${this.#onDragEnd}>\r\n\t\t\t\t\t\t<div class=\"inner\">\r\n\t\t\t\t\t\t\t${when(item.icon, () => html`<umb-icon .name=${item.icon}></umb-icon>`)}\r\n\t\t\t\t\t\t\t<span>${this.localize.string(item.label)}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t`;\r\n\t}\r\n\r\n\t#renderDesigner() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"toolbar\">\r\n\t\t\t\t<div id=\"rows\">\r\n\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\tthis._toolbar,\r\n\t\t\t\t\t\t(row) => row.unique,\r\n\t\t\t\t\t\t(row, idx) => this.#renderRow(row, idx),\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tid=\"btnAddRow\"\r\n\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\tlabel=${this.localize.term('tiptap_toolbar_addRow')}\r\n\t\t\t\t\t@click=${() => this.#context.insertToolbarRow(this._toolbar.length)}></uui-button>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderRow(row?: UmbTiptapToolbarRowViewModel, rowIndex = 0) {\r\n\t\tif (!row) return nothing;\r\n\t\tconst hideActionBar = this._toolbar.length === 1;\r\n\t\treturn html`\r\n\t\t\t<uui-button-inline-create\r\n\t\t\t\tlabel=${this.localize.term('tiptap_toolbar_addRow')}\r\n\t\t\t\t@click=${() => this.#context?.insertToolbarRow(rowIndex)}></uui-button-inline-create>\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"groups\">\r\n\t\t\t\t\t<uui-button-inline-create\r\n\t\t\t\t\t\tvertical\r\n\t\t\t\t\t\tlabel=${this.localize.term('tiptap_toolbar_addGroup')}\r\n\t\t\t\t\t\t@click=${() => this.#context?.insertToolbarGroup(rowIndex, 0)}></uui-button-inline-create>\r\n\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\trow.data,\r\n\t\t\t\t\t\t(group) => group.unique,\r\n\t\t\t\t\t\t(group, idx) => this.#renderGroup(group, rowIndex, idx),\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t${when(\r\n\t\t\t\t\t!hideActionBar,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-action-bar>\r\n\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\t\t\tlabel=${this.localize.term('tiptap_toolbar_removeRow')}\r\n\t\t\t\t\t\t\t\t@click=${() => this.#context?.removeToolbarRow(rowIndex)}>\r\n\t\t\t\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t</uui-action-bar>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderGroup(group?: UmbTiptapToolbarGroupViewModel, rowIndex = 0, groupIndex = 0) {\r\n\t\tif (!group) return nothing;\r\n\t\tconst showActionBar = this._toolbar[rowIndex].data.length > 1 && group.data.length === 0;\r\n\t\treturn html`\r\n\t\t\t<div\r\n\t\t\t\tclass=\"group\"\r\n\t\t\t\tdropzone=\"move\"\r\n\t\t\t\t@dragover=${this.#onDragOver}\r\n\t\t\t\t@drop=${(e: DragEvent) => this.#onDrop(e, [rowIndex, groupIndex, group.data.length - 1])}>\r\n\t\t\t\t<div class=\"items\">\r\n\t\t\t\t\t${when(\r\n\t\t\t\t\t\tgroup?.data.length === 0,\r\n\t\t\t\t\t\t() => html`<em><umb-localize key=\"toolbar_emptyGroup\">Empty</umb-localize></em>`,\r\n\t\t\t\t\t\t() => html`${group!.data.map((alias, idx) => this.#renderItem(alias, rowIndex, groupIndex, idx))}`,\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t${when(\r\n\t\t\t\t\tshowActionBar,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-action-bar>\r\n\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\t\t\tlabel=${this.localize.term('tiptap_toolbar_removeGroup')}\r\n\t\t\t\t\t\t\t\t@click=${() => this.#context?.removeToolbarGroup(rowIndex, groupIndex)}>\r\n\t\t\t\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t</uui-action-bar>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t\t<uui-button-inline-create\r\n\t\t\t\tvertical\r\n\t\t\t\tlabel=${this.localize.term('tiptap_toolbar_addGroup')}\r\n\t\t\t\t@click=${() => this.#context?.insertToolbarGroup(rowIndex, groupIndex + 1)}></uui-button-inline-create>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(alias: string, rowIndex = 0, groupIndex = 0, itemIndex = 0) {\r\n\t\tconst item = this.#context?.getExtensionByAlias(alias);\r\n\t\tif (!item) return nothing;\r\n\t\tconst forbidden = !this.#context?.isExtensionEnabled(item.alias);\r\n\t\treturn html`\r\n\t\t\t<uui-button\r\n\t\t\t\tcompact\r\n\t\t\t\tclass=${forbidden ? 'forbidden' : ''}\r\n\t\t\t\tdraggable=\"true\"\r\n\t\t\t\tlook=${forbidden ? 'placeholder' : 'outline'}\r\n\t\t\t\ttitle=${this.localize.string(item.label)}\r\n\t\t\t\t?disabled=${forbidden}\r\n\t\t\t\t@click=${() => this.#context.removeToolbarItem([rowIndex, groupIndex, itemIndex])}\r\n\t\t\t\t@dragend=${this.#onDragEnd}\r\n\t\t\t\t@dragstart=${(e: DragEvent) => this.#onDragStart(e, alias, [rowIndex, groupIndex, itemIndex])}>\r\n\t\t\t\t<div class=\"inner\">\r\n\t\t\t\t\t${when(\r\n\t\t\t\t\t\titem.icon,\r\n\t\t\t\t\t\t() => html`<umb-icon .name=${item.icon}></umb-icon>`,\r\n\t\t\t\t\t\t() => html`<span>${this.localize.string(item.label)}</span>`,\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</uui-button>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override readonly styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t\tflex-grow: 1;\r\n\t\t\t}\r\n\r\n\t\t\t@media (min-width: 1400px) {\r\n\t\t\t\t:host {\r\n\t\t\t\t\tflex-direction: row;\r\n\t\t\t\t}\r\n\t\t\t\t#toolbox {\r\n\t\t\t\t\twidth: 500px;\r\n\t\t\t\t\tmax-width: 33%;\r\n\t\t\t\t\tflex-grow: 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t#toolbar {\r\n\t\t\t\t\tflex-grow: 100;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t#toolbox {\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\tuui-box.minimal {\r\n\t\t\t\t--uui-box-header-padding: 0;\r\n\t\t\t\t--uui-box-default-padding: var(--uui-size-2) 0;\r\n\t\t\t\t--uui-box-box-shadow: none;\r\n\r\n\t\t\t\t[slot='header-actions'] {\r\n\t\t\t\t\tmargin-bottom: var(--uui-size-2);\r\n\r\n\t\t\t\t\tuui-icon {\r\n\t\t\t\t\t\tcolor: var(--uui-color-border);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.available-items {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\tgap: var(--uui-size-3);\r\n\r\n\t\t\t\tuui-button {\r\n\t\t\t\t\t--uui-button-font-weight: normal;\r\n\r\n\t\t\t\t\t&[draggable='true'],\r\n\t\t\t\t\t&[draggable='true'] > .inner {\r\n\t\t\t\t\t\tcursor: move;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&[disabled],\r\n\t\t\t\t\t&[disabled] > .inner {\r\n\t\t\t\t\t\tcursor: not-allowed;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&.forbidden {\r\n\t\t\t\t\t\t--color: var(--uui-color-danger);\r\n\t\t\t\t\t\t--color-standalone: var(--uui-color-danger-standalone);\r\n\t\t\t\t\t\t--color-emphasis: var(--uui-color-danger-emphasis);\r\n\t\t\t\t\t\t--color-contrast: var(--uui-color-danger);\r\n\t\t\t\t\t\t--uui-button-contrast-disabled: var(--uui-color-danger);\r\n\t\t\t\t\t\t--uui-button-border-color-disabled: var(--uui-color-danger);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdiv {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tgap: var(--uui-size-1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tuui-button-inline-create:not([vertical]) {\r\n\t\t\t\tmargin-bottom: -4px;\r\n\t\t\t}\r\n\r\n\t\t\t#rows {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-1);\r\n\r\n\t\t\t\t.row {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: flex-start;\r\n\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\tgap: var(--uui-size-3);\r\n\r\n\t\t\t\t\t&:not(:last-child) {\r\n\t\t\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&:focus-within,\r\n\t\t\t\t\t&:hover {\r\n\t\t\t\t\t\tborder-color: var(--uui-color-border-standalone);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.groups {\r\n\t\t\t\t\t\tflex: 1;\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tflex-direction: row;\r\n\t\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\tjustify-content: flex-start;\r\n\t\t\t\t\t\tgap: var(--uui-size-1);\r\n\r\n\t\t\t\t\t\tuui-button-inline-create {\r\n\t\t\t\t\t\t\theight: 50px;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.group {\r\n\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\tflex-direction: row;\r\n\t\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\t\t\tgap: var(--uui-size-3);\r\n\r\n\t\t\t\t\t\t\tborder: 1px dashed transparent;\r\n\t\t\t\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\t\t\t\tpadding: var(--uui-size-3);\r\n\r\n\t\t\t\t\t\t\t> uui-action-bar {\r\n\t\t\t\t\t\t\t\topacity: 0;\r\n\t\t\t\t\t\t\t\ttransition: opacity 120ms;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t&:focus-within,\r\n\t\t\t\t\t\t\t&:hover {\r\n\t\t\t\t\t\t\t\tborder-color: var(--uui-color-border-standalone);\r\n\t\t\t\t\t\t\t\t> uui-action-bar {\r\n\t\t\t\t\t\t\t\t\topacity: 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t.items {\r\n\t\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\t\tflex-direction: row;\r\n\t\t\t\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\t\t\tgap: var(--uui-size-1);\r\n\r\n\t\t\t\t\t\t\t\tuui-button {\r\n\t\t\t\t\t\t\t\t\t--uui-button-font-weight: normal;\r\n\r\n\t\t\t\t\t\t\t\t\t&[draggable='true'],\r\n\t\t\t\t\t\t\t\t\t&[draggable='true'] > .inner {\r\n\t\t\t\t\t\t\t\t\t\tcursor: move;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t&[disabled],\r\n\t\t\t\t\t\t\t\t\t&[disabled] > .inner {\r\n\t\t\t\t\t\t\t\t\t\tcursor: not-allowed;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t&.forbidden {\r\n\t\t\t\t\t\t\t\t\t\t--color: var(--uui-color-danger);\r\n\t\t\t\t\t\t\t\t\t\t--color-standalone: var(--uui-color-danger-standalone);\r\n\t\t\t\t\t\t\t\t\t\t--color-emphasis: var(--uui-color-danger-emphasis);\r\n\t\t\t\t\t\t\t\t\t\t--color-contrast: var(--uui-color-danger);\r\n\t\t\t\t\t\t\t\t\t\t--uui-button-contrast-disabled: var(--uui-color-danger);\r\n\t\t\t\t\t\t\t\t\t\t--uui-button-border-color-disabled: var(--uui-color-danger);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tdiv {\r\n\t\t\t\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\t\t\t\tgap: var(--uui-size-1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t#btnAddRow {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tmargin-top: var(--uui-size-1);\r\n\t\t\t}\r\n\r\n\t\t\t.handle {\r\n\t\t\t\tcursor: move;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { UmbPropertyEditorUiTiptapToolbarConfigurationElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-tiptap-toolbar-configuration': UmbPropertyEditorUiTiptapToolbarConfigurationElement;\r\n\t}\r\n}\r\n"],"names":["UmbTiptapToolbarConfigurationContext","UmbContextBase","host","UMB_TIPTAP_TOOLBAR_CONFIGURATION_CONTEXT","#extensions","UmbArrayState","x","#reload","UmbBooleanState","#extensionsEnabled","#extensionsInUse","#toolbar","#tinyMceToolbarMapping","umbExtensionsRegistry","extensions","_extensions","ext","#lookup","UMB_PROPERTY_DATASET_CONTEXT","dataset","z","alias","value","row","group","query","to","toolbar","rowIndex","groupIndex","itemIndex","rowData","items","groups","UmbId","mapping","from","fromRowIndex","fromGroupIndex","fromItemIndex","toRowIndex","toGroupIndex","toItemIndex","fromRow","fromRowData","fromGroup","fromItems","toBeMoved","toRow","toRowData","toGroup","toItems","_context","_currentDragItem","_debouncedFilter","_value","_UmbPropertyEditorUiTiptapToolbarConfigurationElement_instances","onClick_fn","onDragStart_fn","onDragOver_fn","onDragEnd_fn","onDrop_fn","onFilterInput_fn","renderAvailableItems_fn","renderAvailableItem_fn","renderDesigner_fn","renderRow_fn","renderGroup_fn","renderItem_fn","UmbPropertyEditorUiTiptapToolbarConfigurationElement","UmbLitElement","__privateAdd","debounce","__privateGet","UMB_PROPERTY_CONTEXT","propertyContext","reload","__privateSet","rows","html","__privateMethod","item","lastRow","lastGroup","lastItem","event","fromPos","toPos","when","repeat","forbidden","inUse","nothing","e","idx","hideActionBar","showActionBar","UmbTextStyles","css","__decorateClass","state","property","customElement"],"mappings":"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"}