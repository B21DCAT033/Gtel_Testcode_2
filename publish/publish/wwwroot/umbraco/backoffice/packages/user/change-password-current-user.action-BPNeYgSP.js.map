{"version":3,"file":"change-password-current-user.action-BPNeYgSP.js","sources":["../../../src/packages/user/current-user/profile/change-password-current-user.action.ts"],"sourcesContent":["import { UMB_CURRENT_USER_CONTEXT } from '../current-user.context.token.js';\r\nimport { UmbCurrentUserRepository } from '../repository/index.js';\r\nimport type { UmbCurrentUserAction, UmbCurrentUserActionArgs } from '../current-user-action.extension.js';\r\nimport { UmbActionBase } from '@umbraco-cms/backoffice/action';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_CHANGE_PASSWORD_MODAL } from '@umbraco-cms/backoffice/user-change-password';\r\nexport class UmbChangePasswordCurrentUserAction<ArgsMetaType = never>\r\n\textends UmbActionBase<UmbCurrentUserActionArgs<ArgsMetaType>>\r\n\timplements UmbCurrentUserAction<ArgsMetaType>\r\n{\r\n\t#unique?: string;\r\n\r\n\tconstructor(host: UmbControllerHost, args: UmbCurrentUserActionArgs<ArgsMetaType>) {\r\n\t\tsuper(host, args);\r\n\r\n\t\tthis.consumeContext(UMB_CURRENT_USER_CONTEXT, (context) => {\r\n\t\t\tthis.observe(\r\n\t\t\t\tcontext.unique,\r\n\t\t\t\t(unique) => {\r\n\t\t\t\t\tthis.#unique = unique;\r\n\t\t\t\t},\r\n\t\t\t\t'umbEditCurrentUserActionObserver',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tasync getHref() {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tasync execute() {\r\n\t\tif (!this.#unique) return;\r\n\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tconst modalContext = modalManager.open(this, UMB_CHANGE_PASSWORD_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tuser: {\r\n\t\t\t\t\tunique: this.#unique,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tconst data = await modalContext.onSubmit();\r\n\t\tconst repository = new UmbCurrentUserRepository(this);\r\n\t\tawait repository.changePassword(data.newPassword, data.oldPassword);\r\n\t}\r\n}\r\n\r\nexport { UmbChangePasswordCurrentUserAction as api };\r\n"],"names":["UmbChangePasswordCurrentUserAction","UmbActionBase","#unique","host","args","UMB_CURRENT_USER_CONTEXT","context","unique","data","UMB_MODAL_MANAGER_CONTEXT","UMB_CHANGE_PASSWORD_MODAL","UmbCurrentUserRepository"],"mappings":";;;;;;;;;AAOO,MAAMA,UACJC,EAET;AAAA,EACCC;AAAA,EAEA,YAAYC,GAAyBC,GAA8C;AAClF,UAAMD,GAAMC,CAAI,GAEX,KAAA,eAAeC,GAA0B,CAACC,MAAY;AACrD,WAAA;AAAA,QACJA,EAAQ;AAAA,QACR,CAACC,MAAW;AACX,eAAKL,KAAUK;AAAA,QAChB;AAAA,QACA;AAAA,MACD;AAAA,IAAA,CACA;AAAA,EAAA;AAAA,EAGF,MAAM,UAAU;AAAA,EACR;AAAA,EAGR,MAAM,UAAU;AACX,QAAA,CAAC,KAAKL,GAAS;AAWb,UAAAM,IAAO,OATQ,MAAM,KAAK,WAAWC,CAAyB,GAClC,KAAK,MAAMC,GAA2B;AAAA,MACvE,MAAM;AAAA,QACL,MAAM;AAAA,UACL,QAAQ,KAAKR;AAAA,QAAA;AAAA,MACd;AAAA,IACD,CACA,EAE+B,SAAS;AAEzC,UADmB,IAAIS,EAAyB,IAAI,EACnC,eAAeH,EAAK,aAAaA,EAAK,WAAW;AAAA,EAAA;AAEpE;"}